//-----------------------------------------------------------------------
// Description: Efficient Sample Rate Converter with the following ratios
//    6/5
//    7/8
//    9/10
//    9/8
//    The SRC consist of up- and down-sampler. 
//    A fir filter is decomposed into polyphase subfilters which makes it possible
//    to compute the down-sample part before the up-sampling part witout loss of bandwith but having less computational complexity.
//
// Author:       Kim Radmacher
//
// Date:         09.04.2022
//
// Copyright (C) 2022 Kim Radmacher
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
// express or implied.
// See the License for the specific language governing permissions
// and limitations under the License.
//----------------------------------------------------------------------------

#include <math.h>
#include <stdio.h>
#include <stdint.h>
#include <string.h>

//#define DEBUG

#if defined(_MSC_VER)
#include <getopt.h>
#else
#include <unistd.h>
#endif

#include "src.h"

/* define number of coefficients per polyphase                                 */
/* USE_1_COEFFICIENTS -> leads to filter order   L*M (bet. 50 and 60 dB)       */
/*                       polyphase filters only consists of one multiplication */
/* USE_2_COEFFICIENTS -> leads to filter order 2*L*M (bet. 70 and 90 dB)       */
/*                       leads to 1st order fir polyphase filters              */
/* USE_3_COEFFICIENTS -> leads to filter order 3*L*M (>= 90 dB)                */
/*                       leads to 2nd order fir polyphase filters              */
#define USE_2_COEFFICIENTS

#define SRCC 
/*******************************************************************************/
/* the coefficients were calculated with     "SRC_L_M_test.m"     at:          */
/* The original calculated prototype filter coefficient are reordered reg.     */
/* the down- and upsampling factor to obtain the coeff. for each poly. filter. */
/* From prototype filter coefficients: 1,2,3,...,3*M*L                         */
/* to                                                                          */
/* polyphase filter 1,   coeff. 1,   M*L,   2*M*L                              */
/* polyphase filter 2,   coeff. 2,   M*L+1, 2*M*L+1                            */
/* polyphase filter 3,   coeff. 3,   M*L+2, 2*M*L+2                            */
/* ...                                                                         */
/* polyphase filter M*L, coeff. M*L, M*L+N, 2*M*L+M*L                          */
/*******************************************************************************/

#ifdef USE_3_COEFFICIENTS
static const float gain_9to10 = (1.096306540835798);
static const float gain_9to8  = (1.096393074550050);
static const float gain_7to8  = (1.096333847250026);
static const float gain_6to5  = (1.154686049425246);
#else /* USE_2_COEFFICIENTS */
static const float gain_9to10 = (1.0964211463218 * 0.952857);
static const float gain_9to8  = (1.0964183914442);
static const float gain_7to8  = (1.0963978181015);
static const float gain_6to5  = (1.1547619322546);
#endif

#ifdef USE_1_COEFFICIENTS
static const float hProtoFIR9to10[N_PROTO_FIR_9TO10]=
{
 SRCC(-0.008351), SRCC(0.015154), SRCC(0.016682), SRCC(0.022259), SRCC(0.029967), SRCC(0.039007), SRCC(0.048882), SRCC(0.059130),
 SRCC(0.069241), SRCC(0.078648), SRCC(0.086749), SRCC(0.092916), SRCC(0.096547), SRCC(0.097104), SRCC(0.094151), SRCC(0.087400),
 SRCC(0.076743), SRCC(0.062282), SRCC(0.044351), SRCC(0.023522), SRCC(0.000596), SRCC(-0.023417), SRCC(-0.047324), SRCC(-0.069800),
 SRCC(-0.089440), SRCC(-0.104863), SRCC(-0.114697), SRCC(-0.117841), SRCC(-0.113243), SRCC(-0.100229), SRCC(-0.078464), SRCC(-0.047961),
 SRCC(-0.009131), SRCC(0.037207), SRCC(0.089856), SRCC(0.147272), SRCC(0.207616), SRCC(0.268849), SRCC(0.328815), SRCC(0.385298),
 SRCC(0.436188), SRCC(0.479523), SRCC(0.513620), SRCC(0.537135), SRCC(0.549133), SRCC(0.549133), SRCC(0.537135), SRCC(0.513620),
 SRCC(0.479523), SRCC(0.436188), SRCC(0.385298), SRCC(0.328815), SRCC(0.268849), SRCC(0.207616), SRCC(0.147272), SRCC(0.089856),
 SRCC(0.037207), SRCC(-0.009131), SRCC(-0.047961), SRCC(-0.078464), SRCC(-0.100229), SRCC(-0.113243), SRCC(-0.117841), SRCC(-0.114697),
 SRCC(-0.104863), SRCC(-0.089440), SRCC(-0.069800), SRCC(-0.047324), SRCC(-0.023417), SRCC(0.000596), SRCC(0.023522), SRCC(0.044351),
 SRCC(0.062282), SRCC(0.076743), SRCC(0.087400), SRCC(0.094151), SRCC(0.097104), SRCC(0.096547), SRCC(0.092916), SRCC(0.086749),
 SRCC(0.078648), SRCC(0.069241), SRCC(0.059130), SRCC(0.048882), SRCC(0.039007), SRCC(0.029967), SRCC(0.022259), SRCC(0.016682),
 SRCC(0.015154), SRCC(-0.008351)
};

static const float hProtoFIR9to8[]={
 SRCC(0.011031), SRCC(0.012356), SRCC(0.018221), SRCC(0.024861), SRCC(0.031850), SRCC(0.038595), SRCC(0.044329), SRCC(0.048244),
 SRCC(0.049462), SRCC(0.047208), SRCC(0.040831), SRCC(0.029940), SRCC(0.014491), SRCC(-0.005159), SRCC(-0.028182), SRCC(-0.053303),
 SRCC(-0.078801), SRCC(-0.102601), SRCC(-0.122378), SRCC(-0.135711), SRCC(-0.140267), SRCC(-0.133978), SRCC(-0.115245), SRCC(-0.083090),
 SRCC(-0.037305), SRCC(0.021462), SRCC(0.091681), SRCC(0.170967), SRCC(0.256190), SRCC(0.343634), SRCC(0.429208), SRCC(0.508703),
 SRCC(0.578057), SRCC(0.633631), SRCC(0.672447), SRCC(0.692401), SRCC(0.692401), SRCC(0.672447), SRCC(0.633631), SRCC(0.578057),
 SRCC(0.508703), SRCC(0.429208), SRCC(0.343634), SRCC(0.256190), SRCC(0.170967), SRCC(0.091681), SRCC(0.021462), SRCC(-0.037305),
 SRCC(-0.083090), SRCC(-0.115245), SRCC(-0.133978), SRCC(-0.140267), SRCC(-0.135711), SRCC(-0.122378), SRCC(-0.102601), SRCC(-0.078801),
 SRCC(-0.053303), SRCC(-0.028182), SRCC(-0.005159), SRCC(0.014491), SRCC(0.029940), SRCC(0.040831), SRCC(0.047208), SRCC(0.049462),
 SRCC(0.048244), SRCC(0.044329), SRCC(0.038595), SRCC(0.031850), SRCC(0.024861), SRCC(0.018221), SRCC(0.012356), SRCC(0.011031),
};

static const float hProtoFIR7to8[]={
 SRCC(-0.007898), SRCC(-0.010007), SRCC(-0.015593), SRCC(-0.022467), SRCC(-0.030429), SRCC(-0.039132), SRCC(-0.048016), SRCC(-0.056384),
 SRCC(-0.063355), SRCC(-0.067944), SRCC(-0.069111), SRCC(-0.065820), SRCC(-0.057135), SRCC(-0.042281), SRCC(-0.020738), SRCC(0.007683),
 SRCC(0.042801), SRCC(0.084025), SRCC(0.130355), SRCC(0.180403), SRCC(0.232446), SRCC(0.284514), SRCC(0.334486), SRCC(0.380218),
 SRCC(0.419668), SRCC(0.451017), SRCC(0.472791), SRCC(0.483946), SRCC(0.483946), SRCC(0.472791), SRCC(0.451017), SRCC(0.419668),
 SRCC(0.380218), SRCC(0.334486), SRCC(0.284514), SRCC(0.232446), SRCC(0.180403), SRCC(0.130355), SRCC(0.084025), SRCC(0.042801),
 SRCC(0.007683), SRCC(-0.020738), SRCC(-0.042281), SRCC(-0.057135), SRCC(-0.065820), SRCC(-0.069111), SRCC(-0.067944), SRCC(-0.063355),
 SRCC(-0.056384), SRCC(-0.048016), SRCC(-0.039132), SRCC(-0.030429), SRCC(-0.022467), SRCC(-0.015593), SRCC(-0.010007), SRCC(-0.007898),
};

static const float hProtoFIR6to5[]={
 SRCC(-0.023186), SRCC(-0.031917), SRCC(-0.046272), SRCC(-0.056654), SRCC(-0.057398), SRCC(-0.042589), SRCC(-0.007159), SRCC(0.051728),
 SRCC(0.133579), SRCC(0.234022), SRCC(0.344924), SRCC(0.455269), SRCC(0.552703), SRCC(0.625468), SRCC(0.664371), SRCC(0.664371),
 SRCC(0.625468), SRCC(0.552703), SRCC(0.455269), SRCC(0.344924), SRCC(0.234022), SRCC(0.133579), SRCC(0.051728), SRCC(-0.007159),
 SRCC(-0.042589), SRCC(-0.057398), SRCC(-0.056654), SRCC(-0.046272), SRCC(-0.031917), SRCC(-0.023186)
};

#else /* 2 Coeff per polyphase */
#ifdef USE_2_COEFFICIENTS
#ifndef FUNCTION_src9to10
/* these ones are reorderd regarding polyphases */
static const float hProtoFIR9to10[]={
 SRCC(0.000003), SRCC(0.850234), SRCC(0.000007), SRCC(0.819203), SRCC(0.000013), SRCC(0.759269), SRCC(0.000022), SRCC(0.674503),
 SRCC(0.000033), SRCC(0.570583), SRCC(0.000045), SRCC(0.454311), SRCC(0.000055), SRCC(0.333060), SRCC(0.000059), SRCC(0.214176),
 SRCC(0.000054), SRCC(0.104410), SRCC(0.000034), SRCC(0.009419), SRCC(-0.000005), SRCC(-0.066621), SRCC(-0.000067), SRCC(-0.121246),
 SRCC(-0.000153), SRCC(-0.153790), SRCC(-0.000260), SRCC(-0.165296), SRCC(-0.000379), SRCC(-0.158297), SRCC(-0.000499), SRCC(-0.136469),
 SRCC(-0.000599), SRCC(-0.104223), SRCC(-0.000658), SRCC(-0.066255), SRCC(-0.000650), SRCC(-0.027116), SRCC(-0.000553), SRCC(0.009176),
 SRCC(-0.000349), SRCC(0.039428), SRCC(-0.000030), SRCC(0.061465), SRCC(0.000396), SRCC(0.074208), SRCC(0.000905), SRCC(0.077640),
 SRCC(0.001452), SRCC(0.072673), SRCC(0.001973), SRCC(0.060938), SRCC(0.002391), SRCC(0.044537), SRCC(0.002621), SRCC(0.025769),
 SRCC(0.002580), SRCC(0.006871), SRCC(0.002202), SRCC(-0.010200), SRCC(0.001448), SRCC(-0.023935), SRCC(0.000321), SRCC(-0.033366),
 SRCC(-0.001124), SRCC(-0.038103), SRCC(-0.002776), SRCC(-0.038294), SRCC(-0.004471), SRCC(-0.034542), SRCC(-0.006002), SRCC(-0.027777),
 SRCC(-0.007137), SRCC(-0.019119), SRCC(-0.007642), SRCC(-0.009731), SRCC(-0.007319), SRCC(-0.000689), SRCC(-0.006031), SRCC(0.007118),
 SRCC(-0.003742), SRCC(0.013058), SRCC(-0.000533), SRCC(0.016788), SRCC(0.003379), SRCC(0.018249), SRCC(0.007643), SRCC(0.017630),
 SRCC(0.011799), SRCC(0.015312), SRCC(0.015312), SRCC(0.011799), SRCC(0.017630), SRCC(0.007643), SRCC(0.018249), SRCC(0.003379),
 SRCC(0.016788), SRCC(-0.000533), SRCC(0.013058), SRCC(-0.003742), SRCC(0.007118), SRCC(-0.006031), SRCC(-0.000689), SRCC(-0.007319),
 SRCC(-0.009731), SRCC(-0.007642), SRCC(-0.019119), SRCC(-0.007137), SRCC(-0.027777), SRCC(-0.006002), SRCC(-0.034542), SRCC(-0.004471),
 SRCC(-0.038294), SRCC(-0.002776), SRCC(-0.038103), SRCC(-0.001124), SRCC(-0.033366), SRCC(0.000321), SRCC(-0.023935), SRCC(0.001448),
 SRCC(-0.010200), SRCC(0.002202), SRCC(0.006871), SRCC(0.002580), SRCC(0.025769), SRCC(0.002621), SRCC(0.044537), SRCC(0.002391),
 SRCC(0.060938), SRCC(0.001973), SRCC(0.072673), SRCC(0.001452), SRCC(0.077640), SRCC(0.000905), SRCC(0.074208), SRCC(0.000396),
 SRCC(0.061465), SRCC(-0.000030), SRCC(0.039428), SRCC(-0.000349), SRCC(0.009176), SRCC(-0.000553), SRCC(-0.027116), SRCC(-0.000650),
 SRCC(-0.066255), SRCC(-0.000658), SRCC(-0.104223), SRCC(-0.000599), SRCC(-0.136469), SRCC(-0.000499), SRCC(-0.158297), SRCC(-0.000379),
 SRCC(-0.165296), SRCC(-0.000260), SRCC(-0.153790), SRCC(-0.000153), SRCC(-0.121246), SRCC(-0.000067), SRCC(-0.066621), SRCC(-0.000005),
 SRCC(0.009419), SRCC(0.000034), SRCC(0.104410), SRCC(0.000054), SRCC(0.214176), SRCC(0.000059), SRCC(0.333060), SRCC(0.000055),
 SRCC(0.454311), SRCC(0.000045), SRCC(0.570583), SRCC(0.000033), SRCC(0.674503), SRCC(0.000022), SRCC(0.759269), SRCC(0.000013),
 SRCC(0.819203), SRCC(0.000007), SRCC(0.850234), SRCC(0.000003)
};
#endif
static const float hProtoFIR9to8[]={
 SRCC(0.000036), SRCC(0.824250), SRCC(0.000065), SRCC(0.795699), SRCC(0.000113), SRCC(0.740473), SRCC(0.000173), SRCC(0.662169),
 SRCC(0.000238), SRCC(0.565812), SRCC(0.000295), SRCC(0.457451), SRCC(0.000326), SRCC(0.343674), SRCC(0.000308), SRCC(0.231099),
 SRCC(0.000217), SRCC(0.125876), SRCC(0.000027), SRCC(0.033249), SRCC(-0.000279), SRCC(-0.042789), SRCC(-0.000710), SRCC(-0.099722),
 SRCC(-0.001256), SRCC(-0.136594), SRCC(-0.001888), SRCC(-0.153969), SRCC(-0.002549), SRCC(-0.153754), SRCC(-0.003162), SRCC(-0.138933),
 SRCC(-0.003628), SRCC(-0.113222), SRCC(-0.003836), SRCC(-0.080694), SRCC(-0.003678), SRCC(-0.045407), SRCC(-0.003059), SRCC(-0.011069),
 SRCC(-0.001921), SRCC(0.019240), SRCC(-0.000259), SRCC(0.043251), SRCC(0.001866), SRCC(0.059604), SRCC(0.004318), SRCC(0.067853),
 SRCC(0.006881), SRCC(0.068381), SRCC(0.009271), SRCC(0.062253), SRCC(0.011159), SRCC(0.051023), SRCC(0.012200), SRCC(0.036516),
 SRCC(0.012075), SRCC(0.020613), SRCC(0.010540), SRCC(0.005063), SRCC(0.007467), SRCC(-0.008677), SRCC(0.002895), SRCC(-0.019538),
 SRCC(-0.002951), SRCC(-0.026894), SRCC(-0.009642), SRCC(-0.030558), SRCC(-0.016563), SRCC(-0.030738), SRCC(-0.022950), SRCC(-0.027956),
 SRCC(-0.027956), SRCC(-0.022950), SRCC(-0.030738), SRCC(-0.016563), SRCC(-0.030558), SRCC(-0.009642), SRCC(-0.026894), SRCC(-0.002951),
 SRCC(-0.019538), SRCC(0.002895), SRCC(-0.008677), SRCC(0.007467), SRCC(0.005063), SRCC(0.010540), SRCC(0.020613), SRCC(0.012075),
 SRCC(0.036516), SRCC(0.012200), SRCC(0.051023), SRCC(0.011159), SRCC(0.062253), SRCC(0.009271), SRCC(0.068381), SRCC(0.006881),
 SRCC(0.067853), SRCC(0.004318), SRCC(0.059604), SRCC(0.001866), SRCC(0.043251), SRCC(-0.000259), SRCC(0.019240), SRCC(-0.001921),
 SRCC(-0.011069), SRCC(-0.003059), SRCC(-0.045407), SRCC(-0.003678), SRCC(-0.080694), SRCC(-0.003836), SRCC(-0.113222), SRCC(-0.003628),
 SRCC(-0.138933), SRCC(-0.003162), SRCC(-0.153754), SRCC(-0.002549), SRCC(-0.153969), SRCC(-0.001888), SRCC(-0.136594), SRCC(-0.001256),
 SRCC(-0.099722), SRCC(-0.000710), SRCC(-0.042789), SRCC(-0.000279), SRCC(0.033249), SRCC(0.000027), SRCC(0.125876), SRCC(0.000217),
 SRCC(0.231099), SRCC(0.000308), SRCC(0.343674), SRCC(0.000326), SRCC(0.457451), SRCC(0.000295), SRCC(0.565812), SRCC(0.000238),
 SRCC(0.662169), SRCC(0.000173), SRCC(0.740473), SRCC(0.000113), SRCC(0.795699), SRCC(0.000065), SRCC(0.824250), SRCC(0.000036),
};

static const float hProtoFIR7to8[]={
 SRCC(0.000000), SRCC(0.826175), SRCC(0.000000), SRCC(0.777001), SRCC(0.000001), SRCC(0.684428), SRCC(0.000003), SRCC(0.559128),
 SRCC(0.000005), SRCC(0.415081), SRCC(0.000007), SRCC(0.267537), SRCC(0.000008), SRCC(0.130888), SRCC(0.000004), SRCC(0.016802),
 SRCC(-0.000009), SRCC(-0.067108), SRCC(-0.000036), SRCC(-0.117883), SRCC(-0.000083), SRCC(-0.137064), SRCC(-0.000150), SRCC(-0.129875),
 SRCC(-0.000230), SRCC(-0.103950), SRCC(-0.000304), SRCC(-0.067860), SRCC(-0.000341), SRCC(-0.029717), SRCC(-0.000295), SRCC(0.003930),
 SRCC(-0.000117), SRCC(0.028769), SRCC(0.000233), SRCC(0.042913), SRCC(0.000767), SRCC(0.046671), SRCC(0.001444), SRCC(0.041989),
 SRCC(0.002157), SRCC(0.031753), SRCC(0.002722), SRCC(0.019069), SRCC(0.002896), SRCC(0.006678), SRCC(0.002414), SRCC(-0.003432),
 SRCC(0.001058), SRCC(-0.010184), SRCC(-0.001263), SRCC(-0.013370), SRCC(-0.004421), SRCC(-0.013461), SRCC(-0.008012), SRCC(-0.011335),
 SRCC(-0.011335), SRCC(-0.008012), SRCC(-0.013461), SRCC(-0.004421), SRCC(-0.013370), SRCC(-0.001263), SRCC(-0.010184), SRCC(0.001058),
 SRCC(-0.003432), SRCC(0.002414), SRCC(0.006678), SRCC(0.002896), SRCC(0.019069), SRCC(0.002722), SRCC(0.031753), SRCC(0.002157),
 SRCC(0.041989), SRCC(0.001444), SRCC(0.046671), SRCC(0.000767), SRCC(0.042913), SRCC(0.000233), SRCC(0.028769), SRCC(-0.000117),
 SRCC(0.003930), SRCC(-0.000295), SRCC(-0.029717), SRCC(-0.000341), SRCC(-0.067860), SRCC(-0.000304), SRCC(-0.103950), SRCC(-0.000230),
 SRCC(-0.129875), SRCC(-0.000150), SRCC(-0.137064), SRCC(-0.000083), SRCC(-0.117883), SRCC(-0.000036), SRCC(-0.067108), SRCC(-0.000009),
 SRCC(0.016802), SRCC(0.000004), SRCC(0.130888), SRCC(0.000008), SRCC(0.267537), SRCC(0.000007), SRCC(0.415081), SRCC(0.000005),
 SRCC(0.559128), SRCC(0.000003), SRCC(0.684428), SRCC(0.000001), SRCC(0.777001), SRCC(0.000000), SRCC(0.826175), SRCC(0.000000),
};

static const float hProtoFIR6to5[]={
 SRCC(-0.000524), SRCC(0.761259), SRCC(-0.001510), SRCC(0.702968), SRCC(-0.003288), SRCC(0.595125), SRCC(-0.005860), SRCC(0.453524),
 SRCC(-0.008939), SRCC(0.298031), SRCC(-0.011832), SRCC(0.148951), SRCC(-0.013464), SRCC(0.023531), SRCC(-0.012561), SRCC(-0.066696),
 SRCC(-0.007994), SRCC(-0.117244), SRCC(0.000752), SRCC(-0.130516), SRCC(0.013126), SRCC(-0.114362), SRCC(0.027213), SRCC(-0.079777),
 SRCC(0.039763), SRCC(-0.038354), SRCC(0.046659), SRCC(-0.000042), SRCC(0.043811), SRCC(0.028367), SRCC(0.028367), SRCC(0.043811),
 SRCC(-0.000042), SRCC(0.046659), SRCC(-0.038354), SRCC(0.039763), SRCC(-0.079777), SRCC(0.027213), SRCC(-0.114362), SRCC(0.013126),
 SRCC(-0.130516), SRCC(0.000752), SRCC(-0.117244), SRCC(-0.007994), SRCC(-0.066696), SRCC(-0.012561), SRCC(0.023531), SRCC(-0.013464),
 SRCC(0.148951), SRCC(-0.011832), SRCC(0.298031), SRCC(-0.008939), SRCC(0.453524), SRCC(-0.005860), SRCC(0.595125), SRCC(-0.003288),
 SRCC(0.702968), SRCC(-0.001510), SRCC(0.761259), SRCC(-0.000524)
};

#else /* 3 Coeff per polyphase */
#ifdef USE_3_COEFFICIENTS

#define DO_NOT_USE_REORDERED_COEFFIZIENTS
#if defined(DO_NOT_USE_REORDERED_COEFFIZIENTS) && !defined(FUNCTION_src9to10)
static const float hProtoFIR9to10[]={
 SRCC(-0.000000), SRCC(0.020854), SRCC(0.011755), SRCC(-0.000001), SRCC(0.028456), SRCC(0.002300), SRCC(-0.000001), SRCC(0.033477),
 SRCC(-0.006446), SRCC(-0.000002), SRCC(0.035023), SRCC(-0.013601), SRCC(-0.000003), SRCC(0.032524), SRCC(-0.018551), SRCC(-0.000004),
 SRCC(0.025837), SRCC(-0.020982), SRCC(-0.000005), SRCC(0.015309), SRCC(-0.020891), SRCC(-0.000005), SRCC(0.001788), SRCC(-0.018551),
 SRCC(-0.000004), SRCC(-0.013427), SRCC(-0.014452), SRCC(-0.000001), SRCC(-0.028690), SRCC(-0.009229), SRCC(0.000003), SRCC(-0.042174),
 SRCC(-0.003568), SRCC(0.000010), SRCC(-0.052062), SRCC(0.001866), SRCC(0.000019), SRCC(-0.056775), SRCC(0.006505), SRCC(0.000029),
 SRCC(-0.055176), SRCC(0.009933), SRCC(0.000040), SRCC(-0.046758), SRCC(0.011910), SRCC(0.000050), SRCC(-0.031766), SRCC(0.012382),
 SRCC(0.000057), SRCC(-0.011257), SRCC(0.011467), SRCC(0.000059), SRCC(0.012946), SRCC(0.009423), SRCC(0.000055), SRCC(0.038377),
 SRCC(0.006601), SRCC(0.000041), SRCC(0.062147), SRCC(0.003398), SRCC(0.000018), SRCC(0.081228), SRCC(0.000208), SRCC(-0.000016),
 SRCC(0.092790), SRCC(-0.002625), SRCC(-0.000058), SRCC(0.094543), SRCC(-0.004836), SRCC(-0.000106), SRCC(0.085058), SRCC(-0.006259),
 SRCC(-0.000154), SRCC(0.064026), SRCC(-0.006837), SRCC(-0.000196), SRCC(0.032422), SRCC(-0.006610), SRCC(-0.000224), SRCC(-0.007452),
 SRCC(-0.005705), SRCC(-0.000231), SRCC(-0.052060), SRCC(-0.004305), SRCC(-0.000209), SRCC(-0.096859), SRCC(-0.002625), SRCC(-0.000155),
 SRCC(-0.136645), SRCC(-0.000883), SRCC(-0.000066), SRCC(-0.166008), SRCC(0.000724), SRCC(0.000053), SRCC(-0.179827), SRCC(0.002039),
 SRCC(0.000195), SRCC(-0.173786), SRCC(0.002960), SRCC(0.000347), SRCC(-0.144850), SRCC(0.003440), SRCC(0.000491), SRCC(-0.091649),
 SRCC(0.003488), SRCC(0.000605), SRCC(-0.014727), SRCC(0.003158), SRCC(0.000668), SRCC(0.083362), SRCC(0.002540), SRCC(0.000661),
 SRCC(0.198148), SRCC(0.001741), SRCC(0.000567), SRCC(0.323507), SRCC(0.000874), SRCC(0.000382), SRCC(0.452095), SRCC(0.000042),
 SRCC(0.000109), SRCC(0.575896), SRCC(-0.000670), SRCC(-0.000234), SRCC(0.686859), SRCC(-0.001203), SRCC(-0.000618), SRCC(0.777545),
 SRCC(-0.001528), SRCC(-0.001001), SRCC(0.841747), SRCC(-0.001641), SRCC(-0.001334), SRCC(0.875012), SRCC(-0.001564), SRCC(-0.001564),
 SRCC(0.875012), SRCC(-0.001334), SRCC(-0.001641), SRCC(0.841747), SRCC(-0.001001), SRCC(-0.001528), SRCC(0.777545), SRCC(-0.000618),
 SRCC(-0.001203), SRCC(0.686859), SRCC(-0.000234), SRCC(-0.000670), SRCC(0.575896), SRCC(0.000109), SRCC(0.000042), SRCC(0.452095),
 SRCC(0.000382), SRCC(0.000874), SRCC(0.323507), SRCC(0.000567), SRCC(0.001741), SRCC(0.198148), SRCC(0.000661), SRCC(0.002540),
 SRCC(0.083362), SRCC(0.000668), SRCC(0.003158), SRCC(-0.014727), SRCC(0.000605), SRCC(0.003488), SRCC(-0.091649), SRCC(0.000491),
 SRCC(0.003440), SRCC(-0.144850), SRCC(0.000347), SRCC(0.002960), SRCC(-0.173786), SRCC(0.000195), SRCC(0.002039), SRCC(-0.179827),
 SRCC(0.000053), SRCC(0.000724), SRCC(-0.166008), SRCC(-0.000066), SRCC(-0.000883), SRCC(-0.136645), SRCC(-0.000155), SRCC(-0.002625),
 SRCC(-0.096859), SRCC(-0.000209), SRCC(-0.004305), SRCC(-0.052060), SRCC(-0.000231), SRCC(-0.005705), SRCC(-0.007452), SRCC(-0.000224),
 SRCC(-0.006610), SRCC(0.032422), SRCC(-0.000196), SRCC(-0.006837), SRCC(0.064026), SRCC(-0.000154), SRCC(-0.006259), SRCC(0.085058),
 SRCC(-0.000106), SRCC(-0.004836), SRCC(0.094543), SRCC(-0.000058), SRCC(-0.002625), SRCC(0.092790), SRCC(-0.000016), SRCC(0.000208),
 SRCC(0.081228), SRCC(0.000018), SRCC(0.003398), SRCC(0.062147), SRCC(0.000041), SRCC(0.006601), SRCC(0.038377), SRCC(0.000055),
 SRCC(0.009423), SRCC(0.012946), SRCC(0.000059), SRCC(0.011467), SRCC(-0.011257), SRCC(0.000057), SRCC(0.012382), SRCC(-0.031766),
 SRCC(0.000050), SRCC(0.011910), SRCC(-0.046758), SRCC(0.000040), SRCC(0.009933), SRCC(-0.055176), SRCC(0.000029), SRCC(0.006505),
 SRCC(-0.056775), SRCC(0.000019), SRCC(0.001866), SRCC(-0.052062), SRCC(0.000010), SRCC(-0.003568), SRCC(-0.042174), SRCC(0.000003),
 SRCC(-0.009229), SRCC(-0.028690), SRCC(-0.000001), SRCC(-0.014452), SRCC(-0.013427), SRCC(-0.000004), SRCC(-0.018551), SRCC(0.001788),
 SRCC(-0.000005), SRCC(-0.020891), SRCC(0.015309), SRCC(-0.000005), SRCC(-0.020982), SRCC(0.025837), SRCC(-0.000004), SRCC(-0.018551),
 SRCC(0.032524), SRCC(-0.000003), SRCC(-0.013601), SRCC(0.035023), SRCC(-0.000002), SRCC(-0.006446), SRCC(0.033477), SRCC(-0.000001),
 SRCC(0.002300), SRCC(0.028456), SRCC(-0.000001), SRCC(0.011755), SRCC(0.020854), SRCC(-0.000000)
};
#else /* DO_NOT_USE_REORDERED_COEFFIZIENTS */
#ifndef FUNCTION_src9to10
static const float hProtoFIR9to10[]={
SRCC(-0.001743), SRCC(0.014313), SRCC(0.032202), SRCC(-0.003945), SRCC(0.029995), SRCC(-0.018781), SRCC(0.004868), SRCC(-0.125698),
SRCC(0.005837), SRCC(-0.004293), SRCC(0.469119), SRCC(0.002687), SRCC(-0.000170), SRCC(0.533440), SRCC(-0.005916), SRCC(0.009173),
SRCC(-0.101575), SRCC(0.005306), SRCC(-0.020844), SRCC(0.006416), SRCC(-0.003475), SRCC(0.030473), SRCC(0.030504), SRCC(-0.002164),
SRCC(-0.031065), SRCC(-0.039193), SRCC(0.000099), SRCC(0.000099), SRCC(-0.039193), SRCC(-0.031065), SRCC(-0.002164), SRCC(0.030504),
SRCC(0.030473), SRCC(-0.003475), SRCC(0.006416), SRCC(-0.020844), SRCC(0.005306), SRCC(-0.101575), SRCC(0.009173), SRCC(-0.005916),
SRCC(0.533440), SRCC(-0.000170), SRCC(0.002687), SRCC(0.469119), SRCC(-0.004293), SRCC(0.005837), SRCC(-0.125698), SRCC(0.004868),
SRCC(-0.018781), SRCC(0.029995), SRCC(-0.003945), SRCC(0.032202), SRCC(0.014313), SRCC(-0.001743), SRCC(0.031825), SRCC(-0.001628),
SRCC(-0.001358), SRCC(-0.000038), SRCC(-0.045180), SRCC(-0.021463), SRCC(-0.002606), SRCC(0.045849), SRCC(0.026887), SRCC(-0.002825),
SRCC(-0.019960), SRCC(-0.021432), SRCC(0.005435), SRCC(-0.066266), SRCC(0.011696), SRCC(-0.007276), SRCC(0.588336), SRCC(-0.002810),
SRCC(0.005583), SRCC(0.397925), SRCC(-0.002528), SRCC(0.001858), SRCC(-0.138780), SRCC(0.004168), SRCC(-0.015282), SRCC(0.049566),
SRCC(-0.004232), SRCC(-0.010485), SRCC(0.064259), SRCC(-0.004345), SRCC(0.029220), SRCC(-0.016319), SRCC(-0.001018), SRCC(-0.000090),
SRCC(-0.048457), SRCC(-0.011106), SRCC(-0.003047), SRCC(0.059223), SRCC(0.021796), SRCC(-0.002009), SRCC(-0.047626), SRCC(-0.020606),
SRCC(0.005218), SRCC(-0.020160), SRCC(0.013303), SRCC(-0.008259), SRCC(0.631598), SRCC(-0.005081), SRCC(0.008324), SRCC(0.322622),
SRCC(-0.000740), SRCC(-0.002538), SRCC(-0.141466), SRCC(0.003265), SRCC(-0.007079), SRCC(-0.134844), SRCC(0.002227), SRCC(-0.004632),
SRCC(0.073572), SRCC(-0.004301), SRCC(0.024410), SRCC(-0.028908), SRCC(-0.000730), SRCC(-0.000180), SRCC(-0.048600), SRCC(-0.000713),
SRCC(-0.003465), SRCC(0.069545), SRCC(0.015629), SRCC(-0.001053), SRCC(-0.074846), SRCC(-0.018514), SRCC(0.004643), SRCC(0.035808),
SRCC(0.013954), SRCC(-0.008766), SRCC(0.661466), SRCC(-0.006869), SRCC(0.010710), SRCC(0.246062), SRCC(0.000959), SRCC(0.012549),
SRCC(0.171043), SRCC(0.002470), SRCC(-0.011462), SRCC(-0.120361), SRCC(0.001119), SRCC(0.008855), SRCC(0.075850), SRCC(-0.003833),
SRCC(0.009044), SRCC(-0.045369), SRCC(-0.000314), SRCC(-0.000314), SRCC(-0.045369), SRCC(0.009044), SRCC(-0.003833), SRCC(0.075850),
SRCC(0.008855), SRCC(0.000006), SRCC(-0.099736), SRCC(-0.015376), SRCC(0.003717), SRCC(0.100184), SRCC(0.013675), SRCC(-0.008726),
SRCC(0.676713), SRCC(-0.008095), SRCC(-0.008095), SRCC(0.676713), SRCC(-0.008726), SRCC(0.013675), SRCC(0.100184), SRCC(0.003717),
SRCC(-0.015376), SRCC(-0.099736), SRCC(0.000006), SRCC(0.008855), SRCC(0.075850), SRCC(-0.003833), SRCC(0.009044), SRCC(-0.045369),
SRCC(-0.000314), SRCC(-0.000496), SRCC(-0.038737), SRCC(0.017575), SRCC(-0.004121), SRCC(0.077365), SRCC(0.001949), SRCC(0.001119),
SRCC(-0.120361), SRCC(-0.011462), SRCC(0.002470), SRCC(0.171043), SRCC(0.012549), SRCC(0.000959), SRCC(0.246062), SRCC(0.010710),
SRCC(-0.006869), SRCC(0.661466), SRCC(-0.008766), SRCC(0.013954), SRCC(0.035808), SRCC(0.004643), SRCC(-0.018514), SRCC(-0.074846),
SRCC(-0.001053), SRCC(0.015629), SRCC(0.069545), SRCC(-0.003465), SRCC(-0.000713), SRCC(-0.048600), SRCC(-0.000180), SRCC(-0.000730),
SRCC(-0.028908), SRCC(0.024410), SRCC(-0.004301), SRCC(0.073572), SRCC(-0.004632), SRCC(0.002227), SRCC(-0.134844), SRCC(-0.007079),
SRCC(0.003265), SRCC(-0.141466), SRCC(-0.002538), SRCC(-0.000740), SRCC(0.322622), SRCC(0.008324), SRCC(-0.005081), SRCC(0.631598),
SRCC(-0.008259), SRCC(0.013303), SRCC(-0.020160), SRCC(0.005218), SRCC(-0.020606), SRCC(-0.047626), SRCC(-0.002009), SRCC(0.021796),
SRCC(0.059223), SRCC(-0.003047), SRCC(-0.011106), SRCC(-0.048457), SRCC(-0.000090), SRCC(-0.001018), SRCC(-0.016319), SRCC(0.029220),
SRCC(-0.004345), SRCC(0.064259), SRCC(-0.010485), SRCC(-0.004232), SRCC(0.049566), SRCC(-0.015282), SRCC(0.004168), SRCC(-0.138780),
SRCC(0.001858), SRCC(-0.002528), SRCC(0.397925), SRCC(0.005583), SRCC(-0.002810), SRCC(0.588336), SRCC(-0.007276), SRCC(0.011696),
SRCC(-0.066266), SRCC(0.005435), SRCC(-0.021432), SRCC(-0.019960), SRCC(-0.002825), SRCC(0.026887), SRCC(0.045849), SRCC(-0.002606),
SRCC(-0.021463), SRCC(-0.045180), SRCC(-0.000038), SRCC(-0.001358), SRCC(-0.001628), SRCC(0.031825)
};
#endif
#endif /*DO_NOT_USE_REORDERED_COEFFIZIENTS*/

/* still 2 coefficients per polyphase b/c it's almost equal to 3 coefficients */
/*LNK_SECTION_DATA_L1*/ static const float hProtoFIR9to8[]={
 SRCC(0.000143), SRCC(0.859650), SRCC(0.000268), SRCC(0.827460), SRCC(0.000487), SRCC(0.765331), SRCC(0.000786), SRCC(0.677573),
 SRCC(0.001160), SRCC(0.570182), SRCC(0.001587), SRCC(0.450335), SRCC(0.002028), SRCC(0.325783), SRCC(0.002427), SRCC(0.204222),
 SRCC(0.002708), SRCC(0.092685), SRCC(0.002788), SRCC(-0.002992), SRCC(0.002583), SRCC(-0.078563), SRCC(0.002022), SRCC(-0.131625),
 SRCC(0.001059), SRCC(-0.161677), SRCC(-0.000308), SRCC(-0.170025), SRCC(-0.002032), SRCC(-0.159527), SRCC(-0.004003), SRCC(-0.134211),
 SRCC(-0.006050), SRCC(-0.098830), SRCC(-0.007950), SRCC(-0.058375), SRCC(-0.009443), SRCC(-0.017615), SRCC(-0.010263), SRCC(0.019309),
 SRCC(-0.010166), SRCC(0.049185), SRCC(-0.008972), SRCC(0.069922), SRCC(-0.006602), SRCC(0.080616), SRCC(-0.003106), SRCC(0.081488),
 SRCC(0.001315), SRCC(0.073728), SRCC(0.006304), SRCC(0.059254), SRCC(0.011368), SRCC(0.040431), SRCC(0.015912), SRCC(0.019772),
 SRCC(0.019298), SRCC(-0.000341), SRCC(0.020918), SRCC(-0.017882), SRCC(0.020279), SRCC(-0.031352), SRCC(0.017082), SRCC(-0.039870),
 SRCC(0.011292), SRCC(-0.043188), SRCC(0.003188), SRCC(-0.041635), SRCC(-0.006619), SRCC(-0.036012), SRCC(-0.017214), SRCC(-0.027442),
 SRCC(-0.027442), SRCC(-0.017214), SRCC(-0.036012), SRCC(-0.006619), SRCC(-0.041635), SRCC(0.003188), SRCC(-0.043188), SRCC(0.011292),
 SRCC(-0.039870), SRCC(0.017082), SRCC(-0.031352), SRCC(0.020279), SRCC(-0.017882), SRCC(0.020918), SRCC(-0.000341), SRCC(0.019298),
 SRCC(0.019772), SRCC(0.015912), SRCC(0.040431), SRCC(0.011368), SRCC(0.059254), SRCC(0.006304), SRCC(0.073728), SRCC(0.001315),
 SRCC(0.081488), SRCC(-0.003106), SRCC(0.080616), SRCC(-0.006602), SRCC(0.069922), SRCC(-0.008972), SRCC(0.049185), SRCC(-0.010166),
 SRCC(0.019309), SRCC(-0.010263), SRCC(-0.017615), SRCC(-0.009443), SRCC(-0.058375), SRCC(-0.007950), SRCC(-0.098830), SRCC(-0.006050),
 SRCC(-0.134211), SRCC(-0.004003), SRCC(-0.159527), SRCC(-0.002032), SRCC(-0.170025), SRCC(-0.000308), SRCC(-0.161677), SRCC(0.001059),
 SRCC(-0.131625), SRCC(0.002022), SRCC(-0.078563), SRCC(0.002583), SRCC(-0.002992), SRCC(0.002788), SRCC(0.092685), SRCC(0.002708),
 SRCC(0.204222), SRCC(0.002427), SRCC(0.325783), SRCC(0.002028), SRCC(0.450335), SRCC(0.001587), SRCC(0.570182), SRCC(0.001160),
 SRCC(0.677573), SRCC(0.000786), SRCC(0.765331), SRCC(0.000487), SRCC(0.827460), SRCC(0.000268), SRCC(0.859650), SRCC(0.000143),
};

static const float hProtoFIR7to8[]={
 SRCC(0.000000), SRCC(-0.018028), SRCC(-0.008185), SRCC(0.000000), SRCC(-0.026537), SRCC(0.000980), SRCC(0.000000), SRCC(-0.031483),
 SRCC(0.007997), SRCC(0.000000), SRCC(-0.030867), SRCC(0.012093), SRCC(0.000000), SRCC(-0.023427), SRCC(0.013186), SRCC(0.000000),
 SRCC(-0.009097), SRCC(0.011752), SRCC(0.000000), SRCC(0.010697), SRCC(0.008619), SRCC(0.000000), SRCC(0.032996), SRCC(0.004734),
 SRCC(-0.000000), SRCC(0.053601), SRCC(0.000962), SRCC(-0.000000), SRCC(0.067692), SRCC(-0.002055), SRCC(-0.000001), SRCC(0.070718),
 SRCC(-0.003966), SRCC(-0.000002), SRCC(0.059409), SRCC(-0.004706), SRCC(-0.000003), SRCC(0.032741), SRCC(-0.004440), SRCC(-0.000004),
 SRCC(-0.007363), SRCC(-0.003476), SRCC(-0.000004), SRCC(-0.055778), SRCC(-0.002169), SRCC(-0.000003), SRCC(-0.104487), SRCC(-0.000844),
 SRCC(-0.000001), SRCC(-0.143486), SRCC(0.000256), SRCC(0.000005), SRCC(-0.162196), SRCC(0.000998), SRCC(0.000014), SRCC(-0.151187),
 SRCC(0.001351), SRCC(0.000026), SRCC(-0.103934), SRCC(0.001364), SRCC(0.000039), SRCC(-0.018299), SRCC(0.001135), SRCC(0.000048),
 SRCC(0.102574), SRCC(0.000779), SRCC(0.000049), SRCC(0.250130), SRCC(0.000400), SRCC(0.000036), SRCC(0.411165), SRCC(0.000073),
 SRCC(0.000003), SRCC(0.569376), SRCC(-0.000159), SRCC(-0.000052), SRCC(0.707514), SRCC(-0.000285), SRCC(-0.000127), SRCC(0.809796),
 SRCC(-0.000318), SRCC(-0.000210), SRCC(0.864188), SRCC(-0.000283), SRCC(-0.000283), SRCC(0.864188), SRCC(-0.000210), SRCC(-0.000318),
 SRCC(0.809796), SRCC(-0.000127), SRCC(-0.000285), SRCC(0.707514), SRCC(-0.000052), SRCC(-0.000159), SRCC(0.569376), SRCC(0.000003),
 SRCC(0.000073), SRCC(0.411165), SRCC(0.000036), SRCC(0.000400), SRCC(0.250130), SRCC(0.000049), SRCC(0.000779), SRCC(0.102574),
 SRCC(0.000048), SRCC(0.001135), SRCC(-0.018299), SRCC(0.000039), SRCC(0.001364), SRCC(-0.103934), SRCC(0.000026), SRCC(0.001351),
 SRCC(-0.151187), SRCC(0.000014), SRCC(0.000998), SRCC(-0.162196), SRCC(0.000005), SRCC(0.000256), SRCC(-0.143486), SRCC(-0.000001),
 SRCC(-0.000844), SRCC(-0.104487), SRCC(-0.000003), SRCC(-0.002169), SRCC(-0.055778), SRCC(-0.000004), SRCC(-0.003476), SRCC(-0.007363),
 SRCC(-0.000004), SRCC(-0.004440), SRCC(0.032741), SRCC(-0.000003), SRCC(-0.004706), SRCC(0.059409), SRCC(-0.000002), SRCC(-0.003966),
 SRCC(0.070718), SRCC(-0.000001), SRCC(-0.002055), SRCC(0.067692), SRCC(-0.000000), SRCC(0.000962), SRCC(0.053601), SRCC(-0.000000),
 SRCC(0.004734), SRCC(0.032996), SRCC(0.000000), SRCC(0.008619), SRCC(0.010697), SRCC(0.000000), SRCC(0.011752), SRCC(-0.009097),
 SRCC(0.000000), SRCC(0.013186), SRCC(-0.023427), SRCC(0.000000), SRCC(0.012093), SRCC(-0.030867), SRCC(0.000000), SRCC(0.007997),
 SRCC(-0.031483), SRCC(0.000000), SRCC(0.000980), SRCC(-0.026537), SRCC(0.000000), SRCC(-0.008185), SRCC(-0.018028), SRCC(0.000000),
};

static const float hProtoFIR6to5[]={
 SRCC(0.000143), SRCC(0.071903), SRCC(0.075521), SRCC(0.000267), SRCC(0.046766), SRCC(0.061092), SRCC(0.000394), SRCC(0.001785),
 SRCC(0.035489), SRCC(0.000393), SRCC(-0.055472), SRCC(0.006784), SRCC(0.000106), SRCC(-0.112160), SRCC(-0.017823), SRCC(-0.000626),
 SRCC(-0.152215), SRCC(-0.033497), SRCC(-0.001893), SRCC(-0.159529), SRCC(-0.038427), SRCC(-0.003635), SRCC(-0.121641), SRCC(-0.033660),
 SRCC(-0.005582), SRCC(-0.033088), SRCC(-0.022278), SRCC(-0.007238), SRCC(0.102403), SRCC(-0.008262), SRCC(-0.007959), SRCC(0.271524),
 SRCC(0.004631), SRCC(-0.007100), SRCC(0.453040), SRCC(0.013713), SRCC(-0.004247), SRCC(0.621282), SRCC(0.017766), SRCC(0.000556),
 SRCC(0.750801), SRCC(0.017006), SRCC(0.006640), SRCC(0.821218), SRCC(0.012704), SRCC(0.012704), SRCC(0.821218), SRCC(0.006640),
 SRCC(0.017006), SRCC(0.750801), SRCC(0.000556), SRCC(0.017766), SRCC(0.621282), SRCC(-0.004247), SRCC(0.013713), SRCC(0.453040),
 SRCC(-0.007100), SRCC(0.004631), SRCC(0.271524), SRCC(-0.007959), SRCC(-0.008262), SRCC(0.102403), SRCC(-0.007238), SRCC(-0.022278),
 SRCC(-0.033088), SRCC(-0.005582), SRCC(-0.033660), SRCC(-0.121641), SRCC(-0.003635), SRCC(-0.038427), SRCC(-0.159529), SRCC(-0.001893),
 SRCC(-0.033497), SRCC(-0.152215), SRCC(-0.000626), SRCC(-0.017823), SRCC(-0.112160), SRCC(0.000106), SRCC(0.006784), SRCC(-0.055472),
 SRCC(0.000393), SRCC(0.035489), SRCC(0.001785), SRCC(0.000394), SRCC(0.061092), SRCC(0.046766), SRCC(0.000267), SRCC(0.075521),
 SRCC(0.071903), SRCC(0.000143)
};

#else
 /* define a number of coefficients! */
#endif /* USE_3_COEFFICIENTS */
#endif /* USE_2_COEFFICIENTS */
#endif /* USE_1_COEFFICIENTS */

#ifdef THIS_SRC_IS_CURRENTLY_NOT_USED
static const float hProtoFIR4to3[]={
  /* this SRC has always 7 coeff per polyphase */
 SRCC(0.000420), SRCC(0.006283), SRCC(0.016134), SRCC(-0.204096), SRCC(-0.092780), SRCC(-0.019795), SRCC(0.010159), SRCC(0.001169),
 SRCC(-0.004084), SRCC(0.047399), SRCC(-0.184791), SRCC(0.043909), SRCC(-0.036094), SRCC(0.006300), SRCC(0.001935), SRCC(-0.014286),
 SRCC(0.047765), SRCC(0.021716), SRCC(0.116790), SRCC(-0.025872), SRCC(-0.001599), SRCC(0.001825), SRCC(-0.016050), SRCC(0.009660),
 SRCC(0.377665), SRCC(0.097339), SRCC(-0.000823), SRCC(-0.008306), SRCC(-0.000094), SRCC(-0.005707), SRCC(-0.045375), SRCC(0.756059),
 SRCC(0.019723), SRCC(0.019961), SRCC(-0.010531), SRCC(-0.003932), SRCC(0.011617), SRCC(-0.077011), SRCC(0.999062), SRCC(-0.053780),
 SRCC(0.023848), SRCC(-0.008291), SRCC(-0.008291), SRCC(0.023848), SRCC(-0.053780), SRCC(0.999062), SRCC(-0.077011), SRCC(0.011617),
 SRCC(-0.003932), SRCC(-0.010531), SRCC(0.019961), SRCC(0.019723), SRCC(0.756059), SRCC(-0.045375), SRCC(-0.005707), SRCC(-0.000094),
 SRCC(-0.008306), SRCC(-0.000823), SRCC(0.097339), SRCC(0.377665), SRCC(0.009660), SRCC(-0.016050), SRCC(0.001825), SRCC(-0.001599),
 SRCC(-0.025872), SRCC(0.116790), SRCC(0.021716), SRCC(0.047765), SRCC(-0.014286), SRCC(0.001935), SRCC(0.006300), SRCC(-0.036094),
 SRCC(0.043909), SRCC(-0.184791), SRCC(0.047399), SRCC(-0.004084), SRCC(0.001169), SRCC(0.010159), SRCC(-0.019795), SRCC(-0.092780),
 SRCC(-0.204096), SRCC(0.016134), SRCC(0.006283), SRCC(0.000420)
};
#endif



void* srcInit(int fs, SAMPLE_RATE_CONVERSION_INDEX sampleRateIndex)
{

  HANDLE_SRC hSrc_create;
  
  hSrc_create = (HANDLE_SRC)malloc(sizeof(SRC_DATA));
  if (hSrc_create == NULL) {
    return NULL;
  }

  memset(hSrc_create, 0, sizeof(SRC_DATA));

  int nDecDelays = 0;   /* number of used delays for decimation (varies in SRC structure) */
  hSrc_create->useSRC = false;
  hSrc_create->upRatio = 1;
  hSrc_create->dnRatio = 1;
  hSrc_create->mm = 0;
  hSrc_create->srIn = fs;

  switch (sampleRateIndex) {
  case SRCI_6_TO_5:
    hSrc_create->useSRC = true;
    nDecDelays = 8;
    hSrc_create->upRatio = 6;
    hSrc_create->dnRatio = 5;
    hSrc_create->filterCoeff = hProtoFIR6to5;
    hSrc_create->srcMLfunc = src6to5;
    hSrc_create->gain = 2*gain_6to5;
    hSrc_create->srOut = fs*6/5;
    break;
  case SRCI_7_TO_8:
    hSrc_create->useSRC = true;
    nDecDelays = 6;
    hSrc_create->upRatio = 7;
    hSrc_create->dnRatio = 8;
    hSrc_create->filterCoeff = hProtoFIR7to8;
    hSrc_create->srcMLfunc = src7to8;
    hSrc_create->gain = 2*gain_7to8;
    hSrc_create->srOut = fs*7/8;
    break;
  case SRCI_9_TO_10:
    hSrc_create->useSRC = true;
    nDecDelays           =  8;
    hSrc_create->upRatio =  9;
    hSrc_create->dnRatio = 10;
    hSrc_create->filterCoeff = hProtoFIR9to10;
    hSrc_create->srcMLfunc = src9to10;
    hSrc_create->gain = 2*gain_9to10;
    hSrc_create->srOut = fs*9/10;
    break;
  case SRCI_9_TO_8:
    hSrc_create->useSRC = true;
    nDecDelays = 14;  
    hSrc_create->upRatio = 9;
    hSrc_create->dnRatio = 8;
    hSrc_create->filterCoeff = hProtoFIR9to8;
    hSrc_create->srcMLfunc = src9to8;
    hSrc_create->gain = 2*gain_9to8;
    hSrc_create->srOut = fs*9/8;
    break;
  default:
    return NULL;
  }

  if(hSrc_create->useSRC){
    /* create (aligned) output buffer for decimation */
    hSrc_create->decimationOutput = (int*)malloc(hSrc_create->upRatio*hSrc_create->dnRatio*sizeof(int));
    /* create (aligned) delays and states for decimation */
    hSrc_create->delays = (float*)malloc(nDecDelays * sizeof(float));
    /* filter states (delays) need to be aligned allocated for XTENSA */
#ifdef USE_3_COEFFICIENTS
    hSrc_create->states = (float*)malloc(N_POLY_3 * hSrc_create->upRatio*hSrc_create->dnRatio*sizeof(float)); /* N_POLY_3 * b/c polyphase filter length is max 3 */
#else /* USE_2_COEFFICIENTS */
    hSrc_create->states = (float*)malloc(N_POLY_2 * hSrc_create->upRatio*hSrc_create->dnRatio*sizeof(float)); /* N_POLY_2 * b/c polyphase filter length is max 2 */
#endif
  }

  return hSrc_create;
}

/* 1st order fir filter */
inline float fir_filter2(float *FIR_delays, const float *FIR_coe, float input)
{
  float FIR_accu32;
  /* load to the highest "position" */
  FIR_delays[1] = input;
  /* do the MAC */
  FIR_accu32 = ( fMultDiv2(FIR_delays[1], FIR_coe[0]) + fMultDiv2(FIR_delays[0], FIR_coe[1]) );
  /* shift the delays */
  FIR_delays[0] = FIR_delays[1];

  return FIR_accu32;
}

/* 2nd order fir filter */
inline float fir_filter3(float *FIR_delays, const float *FIR_coeff, float input)
{
  float FIR_accu32=0;
  /* load to the highest "position" */
  FIR_delays[2] = input;

  /* do the MAC */
  FIR_accu32 = ( fMultDiv2(FIR_delays[2], FIR_coeff[0]) + fMultDiv2(FIR_delays[1], FIR_coeff[1]) + fMultDiv2(FIR_delays[0], FIR_coeff[2]) );

  /* shift the delays */
  FIR_delays[0] = FIR_delays[1];
  FIR_delays[1] = FIR_delays[2];

  return FIR_accu32;
}

/* 6th order fir filter */
inline  float fir_filter7(float *FIR_delays, const float *FIR_coe, float input)
{
  float FIR_accu32;
  /* load to the highest "position" */
  FIR_delays[6] = input;
  /* do the MAC */
  FIR_accu32 = ( fMultDiv2(FIR_delays[6], FIR_coe[0]) + fMultDiv2(FIR_delays[5], FIR_coe[1]) + fMultDiv2(FIR_delays[4], FIR_coe[2]) + fMultDiv2(FIR_delays[3], FIR_coe[3])  \
               + fMultDiv2(FIR_delays[2], FIR_coe[4]) + fMultDiv2(FIR_delays[1], FIR_coe[5]) + fMultDiv2(FIR_delays[0], FIR_coe[6]) );
  /* shift the delays */
  FIR_delays[0] = FIR_delays[1];
  FIR_delays[1] = FIR_delays[2];
  FIR_delays[2] = FIR_delays[3];
  FIR_delays[3] = FIR_delays[4];
  FIR_delays[4] = FIR_delays[5];
  FIR_delays[5] = FIR_delays[6];

  return FIR_accu32;
}


#ifdef USE_1_COEFFICIENTS
int src9to10(  HANDLE_SRC hSrc9to10,
                  int16_t *input,
                  int16_t *output,
                  int     length,
                  int     stride) 
{
  int i;
  int outCnt = 0;
  /* input sample */
  int16_t inp;
  register const float* coeff = hSrc9to10->filterCoeff;
  register int* decOut = hSrc9to10->decimationOutput;
  register float dly1;

  for (i = 0; i < length; i++) {
    /* decimation using polyphase filtering */
    inp = input[i*stride];
    switch (hSrc9to10->mm) {
    case 1:	
      hSrc9to10->mm++;
      decOut[0]  = fMultDiv2(coeff[0] , inp);
      decOut[10] = fMultDiv2(coeff[10], inp);
      decOut[20] = fMultDiv2(coeff[20], inp);
      decOut[30] = fMultDiv2(coeff[30], inp);
      decOut[40] = fMultDiv2(coeff[40], inp);
      decOut[50] = fMultDiv2(coeff[50], inp);
      decOut[60] = fMultDiv2(coeff[60], inp);
      decOut[70] = fMultDiv2(coeff[70], inp);
      decOut[80] = fMultDiv2(coeff[80], inp);
      break;
    case 2:	
      hSrc9to10->mm++;
      decOut[81] = fMultDiv2(coeff[81], hSrc9to10->delays[0]);
      decOut[1]  = fMultDiv2(coeff[1] , inp);
      decOut[11] = fMultDiv2(coeff[11], inp);
      decOut[21] = fMultDiv2(coeff[21], inp);
      decOut[31] = fMultDiv2(coeff[31], inp);
      decOut[41] = fMultDiv2(coeff[41], inp);
      decOut[51] = fMultDiv2(coeff[51], inp);
      decOut[61] = fMultDiv2(coeff[61], inp);
      decOut[71] = fMultDiv2(coeff[71], inp);
      hSrc9to10->delays[0] = inp;
      break;
    case 3:	
      hSrc9to10->mm++;
      dly1 = hSrc9to10->delays[1];
      decOut[72] = fMultDiv2(coeff[72], dly1);
      decOut[82] = fMultDiv2(coeff[82], dly1);
      decOut[2]  = fMultDiv2(coeff[2] , inp);
      decOut[12] = fMultDiv2(coeff[12], inp);
      decOut[22] = fMultDiv2(coeff[22], inp);
      decOut[32] = fMultDiv2(coeff[32], inp);
      decOut[42] = fMultDiv2(coeff[42], inp);
      decOut[52] = fMultDiv2(coeff[52], inp);
      decOut[62] = fMultDiv2(coeff[62], inp); 
      hSrc9to10->delays[1] = inp;
      break;
    case 4:	
      hSrc9to10->mm++;
      dly1 = hSrc9to10->delays[2];
      decOut[63] = fMultDiv2(coeff[63], dly1);
      decOut[73] = fMultDiv2(coeff[73], dly1);
      decOut[83] = fMultDiv2(coeff[83], dly1);
      decOut[3]  = fMultDiv2(coeff[3] , inp);
      decOut[13] = fMultDiv2(coeff[13], inp);
      decOut[23] = fMultDiv2(coeff[23], inp);
      decOut[33] = fMultDiv2(coeff[33], inp);
      decOut[43] = fMultDiv2(coeff[43], inp);
      decOut[53] = fMultDiv2(coeff[53], inp);
      hSrc9to10->delays[2] = inp;
      break;
    case 5:	
      hSrc9to10->mm++;
      dly1 = hSrc9to10->delays[3];
      decOut[54] = fMultDiv2(coeff[54], dly1);
      decOut[64] = fMultDiv2(coeff[64], dly1);
      decOut[74] = fMultDiv2(coeff[74], dly1);
      decOut[84] = fMultDiv2(coeff[84], dly1);
      decOut[4]  = fMultDiv2(coeff[4] , inp);
      decOut[14] = fMultDiv2(coeff[14], inp);
      decOut[24] = fMultDiv2(coeff[24], inp);
      decOut[34] = fMultDiv2(coeff[34], inp);
      decOut[44] = fMultDiv2(coeff[44], inp);
      hSrc9to10->delays[3] = inp;
      break;
    case 6:	
      hSrc9to10->mm++;
      dly1 = hSrc9to10->delays[4];
      decOut[45] = fMultDiv2(coeff[45], dly1);
      decOut[55] = fMultDiv2(coeff[55], dly1);
      decOut[65] = fMultDiv2(coeff[65], dly1);
      decOut[75] = fMultDiv2(coeff[75], dly1);
      decOut[85] = fMultDiv2(coeff[85], dly1);
      decOut[5]  = fMultDiv2(coeff[5] , inp);
      decOut[15] = fMultDiv2(coeff[15], inp);
      decOut[25] = fMultDiv2(coeff[25], inp);
      decOut[35] = fMultDiv2(coeff[35], inp);
      hSrc9to10->delays[4] = inp;
      break;
    case 7:	
      hSrc9to10->mm++;
      dly1 = hSrc9to10->delays[5];
      decOut[36] = fMultDiv2(coeff[36], dly1);
      decOut[46] = fMultDiv2(coeff[46], dly1);
      decOut[56] = fMultDiv2(coeff[56], dly1);
      decOut[66] = fMultDiv2(coeff[66], dly1);
      decOut[76] = fMultDiv2(coeff[76], dly1);
      decOut[86] = fMultDiv2(coeff[86], dly1);
      decOut[6]  = fMultDiv2(coeff[6] , inp);
      decOut[16] = fMultDiv2(coeff[16], inp);
      decOut[26] = fMultDiv2(coeff[26], inp);
      hSrc9to10->delays[5] = inp;
      break;
    case 8:	
      hSrc9to10->mm++;
      dly1 = hSrc9to10->delays[6];
      decOut[27] = fMultDiv2(coeff[27], dly1);
      decOut[37] = fMultDiv2(coeff[37], dly1);
      decOut[47] = fMultDiv2(coeff[47], dly1);
      decOut[57] = fMultDiv2(coeff[57], dly1);
      decOut[67] = fMultDiv2(coeff[67], dly1);
      decOut[77] = fMultDiv2(coeff[77], dly1);
      decOut[87] = fMultDiv2(coeff[87], dly1);
      decOut[7]  = fMultDiv2(coeff[7] , inp);
      decOut[17] = fMultDiv2(coeff[17], inp);
      hSrc9to10->delays[6] = inp;
      break;
    case 9:	
      hSrc9to10->mm++;
      dly1 = hSrc9to10->delays[7];
      decOut[18] = fMultDiv2(coeff[18], dly1);
      decOut[28] = fMultDiv2(coeff[28], dly1);
      decOut[38] = fMultDiv2(coeff[38], dly1);
      decOut[48] = fMultDiv2(coeff[48], dly1);
      decOut[58] = fMultDiv2(coeff[58], dly1);
      decOut[68] = fMultDiv2(coeff[68], dly1);
      decOut[78] = fMultDiv2(coeff[78], dly1);
      decOut[88] = fMultDiv2(coeff[88], dly1);
      decOut[8]  = fMultDiv2(coeff[8] , inp);
      hSrc9to10->delays[7] = inp;
      break;
    case 0:	
      hSrc9to10->mm++;
      decOut[9]  = fMultDiv2(coeff[9] , inp);
      decOut[19] = fMultDiv2(coeff[19], inp);
      decOut[29] = fMultDiv2(coeff[29], inp);
      decOut[39] = fMultDiv2(coeff[39], inp);
      decOut[49] = fMultDiv2(coeff[49], inp);
      decOut[59] = fMultDiv2(coeff[59], inp);
      decOut[69] = fMultDiv2(coeff[69], inp);
      decOut[79] = fMultDiv2(coeff[79], inp);
      decOut[89] = fMultDiv2(coeff[89], inp);
      break;
    default :
      return -1;
      break;
    }

    /* start upsampling by LL if decimation by MM is done */
    if (hSrc9to10->mm >= hSrc9to10->dnRatio){
      /* sum all decimated outputs and reset the switch */
      hSrc9to10->mm = 0;
      output[outCnt++ * stride] = (float)((decOut[0]  + decOut[81] + decOut[72] + decOut[63] + decOut[54] + decOut[45] + decOut[36] + decOut[27] + decOut[18] + decOut[9] ) >> 15);
      output[outCnt++ * stride] = (float)((decOut[10] + decOut[1]  + decOut[82] + decOut[73] + decOut[64] + decOut[55] + decOut[46] + decOut[37] + decOut[28] + decOut[19]) >> 15);
      output[outCnt++ * stride] = (float)((decOut[20] + decOut[11] + decOut[2]  + decOut[83] + decOut[74] + decOut[65] + decOut[56] + decOut[47] + decOut[38] + decOut[29]) >> 15);
      output[outCnt++ * stride] = (float)((decOut[30] + decOut[21] + decOut[12] + decOut[3]  + decOut[84] + decOut[75] + decOut[66] + decOut[57] + decOut[48] + decOut[39]) >> 15);
      output[outCnt++ * stride] = (float)((decOut[40] + decOut[31] + decOut[22] + decOut[13] + decOut[4]  + decOut[85] + decOut[76] + decOut[67] + decOut[58] + decOut[49]) >> 15);
      output[outCnt++ * stride] = (float)((decOut[50] + decOut[41] + decOut[32] + decOut[23] + decOut[14] + decOut[5]  + decOut[86] + decOut[77] + decOut[68] + decOut[59]) >> 15);
      output[outCnt++ * stride] = (float)((decOut[60] + decOut[51] + decOut[42] + decOut[33] + decOut[24] + decOut[15] + decOut[6]  + decOut[87] + decOut[78] + decOut[69]) >> 15);
      output[outCnt++ * stride] = (float)((decOut[70] + decOut[61] + decOut[52] + decOut[43] + decOut[34] + decOut[25] + decOut[16] + decOut[7]  + decOut[88] + decOut[79]) >> 15);
      output[outCnt++ * stride] = (float)((decOut[80] + decOut[71] + decOut[62] + decOut[53] + decOut[44] + decOut[35] + decOut[26] + decOut[17] + decOut[8]  + decOut[89]) >> 15);
    }   /* if dnRatio */
  }     /* for length */

  return (outCnt);
}

int src9to8(  HANDLE_SRC hSrc9to8,
                  int16_t *input,
                  int16_t *output,
                  int     length,
                  int     stride) 
{
  int i;
  int outCnt = 0;
  /* input sample */
  int16_t inp;
  register const float* coeff = hSrc9to8->filterCoeff;
  register int* decOut = hSrc9to8->decimationOutput;
  register float dly2;
  register float dly1;

  for (i = 0; i < length; i++) {
    /* decimation using polyphase filtering */
    inp = input[i*stride];
    switch (hSrc9to8->mm) {
    case 0:	
      hSrc9to8->mm++;
      dly1 = hSrc9to8->delays[0];
      decOut[16] = fMultDiv2(coeff[16], dly1);
      decOut[24] = fMultDiv2(coeff[24], dly1);
      decOut[32] = fMultDiv2(coeff[32], dly1);
      decOut[40] = fMultDiv2(coeff[40], dly1);
      decOut[48] = fMultDiv2(coeff[48], dly1);
      decOut[56] = fMultDiv2(coeff[56], dly1);
      decOut[64] = fMultDiv2(coeff[64], dly1);
      decOut[0]  = fMultDiv2(coeff[0],  inp);
      decOut[8]  = fMultDiv2(coeff[8],  inp);
      hSrc9to8->delays[0] = inp;
      break;
    case 7:	
      hSrc9to8->mm++;
      dly2 = hSrc9to8->delays[2];
      dly1 = hSrc9to8->delays[1];
      decOut[25] = fMultDiv2(coeff[25], dly2);
      decOut[33] = fMultDiv2(coeff[33], dly2);
      decOut[41] = fMultDiv2(coeff[41], dly2);
      decOut[49] = fMultDiv2(coeff[49], dly2);
      decOut[57] = fMultDiv2(coeff[57], dly2);
      decOut[65] = fMultDiv2(coeff[65], dly2);
      decOut[1]  = fMultDiv2(coeff[1],  dly1);
      decOut[9]  = fMultDiv2(coeff[9],  dly1);
      decOut[17] = fMultDiv2(coeff[17], dly1);
      hSrc9to8->delays[2] = hSrc9to8->delays[1] ; 
      hSrc9to8->delays[1] = inp;
      break;
    case 6:	
      hSrc9to8->mm++;
      dly2 = hSrc9to8->delays[4];
      dly1 = hSrc9to8->delays[3];
      decOut[34] = fMultDiv2(coeff[34], dly2);
      decOut[42] = fMultDiv2(coeff[42], dly2);
      decOut[50] = fMultDiv2(coeff[50], dly2);
      decOut[58] = fMultDiv2(coeff[58], dly2);
      decOut[66] = fMultDiv2(coeff[66], dly2);
      decOut[2]  = fMultDiv2(coeff[2],  dly1);
      decOut[10] = fMultDiv2(coeff[10], dly1);
      decOut[18] = fMultDiv2(coeff[18], dly1);
      decOut[26] = fMultDiv2(coeff[26], dly1); 
      hSrc9to8->delays[4] = hSrc9to8->delays[3]; 
      hSrc9to8->delays[3] = inp;
      break;
    case 5:	
      hSrc9to8->mm++;
      dly2 = hSrc9to8->delays[6];
      dly1 = hSrc9to8->delays[5];
      decOut[43] = fMultDiv2(coeff[43], dly2);
      decOut[51] = fMultDiv2(coeff[51], dly2);
      decOut[59] = fMultDiv2(coeff[59], dly2);
      decOut[67] = fMultDiv2(coeff[67], dly2);
      decOut[3]  = fMultDiv2(coeff[3],  dly1);
      decOut[11] = fMultDiv2(coeff[11], dly1);
      decOut[19] = fMultDiv2(coeff[19], dly1);
      decOut[27] = fMultDiv2(coeff[27], dly1);
      decOut[35] = fMultDiv2(coeff[35], dly1);
      hSrc9to8->delays[6] = hSrc9to8->delays[5]; 
      hSrc9to8->delays[5] = inp;
      break;
    case 4:	
      hSrc9to8->mm++;
      dly2 = hSrc9to8->delays[8];
      dly1 = hSrc9to8->delays[7];
      decOut[52] = fMultDiv2(coeff[52], dly2);
      decOut[60] = fMultDiv2(coeff[60], dly2);
      decOut[68] = fMultDiv2(coeff[68], dly2);
      decOut[4]  = fMultDiv2(coeff[4],  dly1);
      decOut[12] = fMultDiv2(coeff[12], dly1);
      decOut[20] = fMultDiv2(coeff[20], dly1);
      decOut[28] = fMultDiv2(coeff[28], dly1);
      decOut[36] = fMultDiv2(coeff[36], dly1);
      decOut[44] = fMultDiv2(coeff[44], dly1);
      hSrc9to8->delays[8] = hSrc9to8->delays[7] ; 
      hSrc9to8->delays[7] = inp;
      break;
    case 3:	
      hSrc9to8->mm++;
      dly2 = hSrc9to8->delays[10];
      dly1 = hSrc9to8->delays[9];
      decOut[61] = fMultDiv2(coeff[61], dly2);
      decOut[69] = fMultDiv2(coeff[69], dly2);
      decOut[5]  = fMultDiv2(coeff[5],  dly1);
      decOut[13] = fMultDiv2(coeff[13], dly1);
      decOut[21] = fMultDiv2(coeff[21], dly1);
      decOut[29] = fMultDiv2(coeff[29], dly1);
      decOut[37] = fMultDiv2(coeff[37], dly1);
      decOut[45] = fMultDiv2(coeff[45], dly1);
      decOut[53] = fMultDiv2(coeff[53], dly1);
      hSrc9to8->delays[10] = hSrc9to8->delays[9] ; 
      hSrc9to8->delays[9] = inp;
      break;
    case 2:	
      hSrc9to8->mm++;
      dly1 = hSrc9to8->delays[11];
      decOut[70] = fMultDiv2(coeff[70], hSrc9to8->delays[12]);
      decOut[6]  = fMultDiv2(coeff[6],  dly1);
      decOut[14] = fMultDiv2(coeff[14], dly1);
      decOut[22] = fMultDiv2(coeff[22], dly1);
      decOut[30] = fMultDiv2(coeff[30], dly1);
      decOut[38] = fMultDiv2(coeff[38], dly1);
      decOut[46] = fMultDiv2(coeff[46], dly1);
      decOut[54] = fMultDiv2(coeff[54], dly1);
      decOut[62] = fMultDiv2(coeff[62], dly1);
      hSrc9to8->delays[12] = hSrc9to8->delays[11];
      hSrc9to8->delays[11] = inp;
      break;
    case 1:	
      hSrc9to8->mm++;
      dly1 = hSrc9to8->delays[13];
      decOut[7]  = fMultDiv2(coeff[7] , dly1);
      decOut[15] = fMultDiv2(coeff[15], dly1);
      decOut[23] = fMultDiv2(coeff[23], dly1);
      decOut[31] = fMultDiv2(coeff[31], dly1);
      decOut[39] = fMultDiv2(coeff[39], dly1);
      decOut[47] = fMultDiv2(coeff[47], dly1);
      decOut[55] = fMultDiv2(coeff[55], dly1);
      decOut[63] = fMultDiv2(coeff[63], dly1);
      decOut[71] = fMultDiv2(coeff[71], dly1);
      hSrc9to8->delays[13] = inp;
      break;

    default :
      return -1;
      break;
    }

    /* start upsampling by LL if decimation by MM is done */
    if (hSrc9to8->mm >= hSrc9to8->dnRatio){
      /* sum all decimated outputs and reset the switch */
      hSrc9to8->mm = 0;
      output[outCnt++ * stride] = (float)((decOut[16] + decOut[25] + decOut[34] + decOut[43] + decOut[52] + decOut[61] + decOut[70] + decOut[7] ) >> 15);
      output[outCnt++ * stride] = (float)((decOut[24] + decOut[33] + decOut[42] + decOut[51] + decOut[60] + decOut[69] + decOut[6]  + decOut[15]) >> 15);
      output[outCnt++ * stride] = (float)((decOut[32] + decOut[41] + decOut[50] + decOut[59] + decOut[68] + decOut[5]  + decOut[14] + decOut[23]) >> 15);
      output[outCnt++ * stride] = (float)((decOut[40] + decOut[49] + decOut[58] + decOut[67] + decOut[4]  + decOut[13] + decOut[22] + decOut[31]) >> 15);
      output[outCnt++ * stride] = (float)((decOut[48] + decOut[57] + decOut[66] + decOut[3]  + decOut[12] + decOut[21] + decOut[30] + decOut[39]) >> 15);
      output[outCnt++ * stride] = (float)((decOut[56] + decOut[65] + decOut[2]  + decOut[11] + decOut[20] + decOut[29] + decOut[38] + decOut[47]) >> 15);
      output[outCnt++ * stride] = (float)((decOut[64] + decOut[1]  + decOut[10] + decOut[19] + decOut[28] + decOut[37] + decOut[46] + decOut[55]) >> 15);
      output[outCnt++ * stride] = (float)((decOut[0]  + decOut[9]  + decOut[18] + decOut[27] + decOut[36] + decOut[45] + decOut[54] + decOut[63]) >> 15);
      output[outCnt++ * stride] = (float)((decOut[8]  + decOut[17] + decOut[26] + decOut[35] + decOut[44] + decOut[53] + decOut[62] + decOut[71]) >> 15);
    }   /* if dnRatio */
  }     /* for length */

  return (outCnt);
}

int src7to8(  HANDLE_SRC hSrc7to8,
                  int16_t *input,
                  int16_t *output,
                  int     length,
                  int     stride) 
{
  int i, outCnt = 0;
  /* input sample */
  int16_t inp;
  register const float* coeff = hSrc7to8->filterCoeff;
  register int* decOut = hSrc7to8->decimationOutput;
  register float dly1;

  for (i = 0; i < length; i++) {
    /* decimation using polyphase filtering */
    inp = input[i*stride];
    switch (hSrc7to8->mm) {
    case 1:	
      hSrc7to8->mm++;
      decOut[0]  = fMultDiv2(coeff[0],  inp);
      decOut[8]  = fMultDiv2(coeff[8],  inp);
      decOut[16] = fMultDiv2(coeff[16], inp);
      decOut[24] = fMultDiv2(coeff[24], inp);
      decOut[32] = fMultDiv2(coeff[32], inp);
      decOut[40] = fMultDiv2(coeff[40], inp);
      decOut[48] = fMultDiv2(coeff[48], inp);
      break;
    case 2:	
      hSrc7to8->mm++;
      decOut[49] = fMultDiv2(coeff[49], hSrc7to8->delays[0]);
      decOut[1]  = fMultDiv2(coeff[1],  inp);
      decOut[9]  = fMultDiv2(coeff[9],  inp);
      decOut[17] = fMultDiv2(coeff[17], inp);
      decOut[25] = fMultDiv2(coeff[25], inp);
      decOut[33] = fMultDiv2(coeff[33], inp);
      decOut[41] = fMultDiv2(coeff[41], inp);
      hSrc7to8->delays[0] = inp;
      break;
    case 3:	
      hSrc7to8->mm++;
      dly1 = hSrc7to8->delays[1];
      decOut[42] = fMultDiv2(coeff[42], dly1);
      decOut[50] = fMultDiv2(coeff[50], dly1);
      decOut[2]  = fMultDiv2(coeff[2],  inp);
      decOut[10] = fMultDiv2(coeff[10], inp);
      decOut[18] = fMultDiv2(coeff[18], inp);
      decOut[26] = fMultDiv2(coeff[26], inp);
      decOut[34] = fMultDiv2(coeff[34], inp);
      hSrc7to8->delays[1] = inp;
      break;
    case 4:	
      hSrc7to8->mm++;
      dly1 = hSrc7to8->delays[2];
      decOut[35] = fMultDiv2(coeff[35], dly1);
      decOut[43] = fMultDiv2(coeff[43], dly1);
      decOut[51] = fMultDiv2(coeff[51], dly1);
      decOut[3]  = fMultDiv2(coeff[3],  inp);
      decOut[11] = fMultDiv2(coeff[11], inp);
      decOut[19] = fMultDiv2(coeff[19], inp);
      decOut[27] = fMultDiv2(coeff[27], inp);
      hSrc7to8->delays[2] = inp;
      break;
    case 5:	
      hSrc7to8->mm++;
      dly1 = hSrc7to8->delays[3];
      decOut[28] = fMultDiv2(coeff[28], dly1);
      decOut[36] = fMultDiv2(coeff[36], dly1);
      decOut[44] = fMultDiv2(coeff[44], dly1);
      decOut[52] = fMultDiv2(coeff[52], dly1);
      decOut[4]  = fMultDiv2(coeff[4],  inp);
      decOut[12] = fMultDiv2(coeff[12], inp);
      decOut[20] = fMultDiv2(coeff[20], inp);
      hSrc7to8->delays[3] = inp;
      break;
    case 6:	
      hSrc7to8->mm++;
      dly1 = hSrc7to8->delays[4];
      decOut[21] = fMultDiv2(coeff[21], dly1);
      decOut[29] = fMultDiv2(coeff[29], dly1);
      decOut[37] = fMultDiv2(coeff[37], dly1);
      decOut[45] = fMultDiv2(coeff[45], dly1);
      decOut[53] = fMultDiv2(coeff[53], dly1);
      decOut[5]  = fMultDiv2(coeff[5],  inp);
      decOut[13] = fMultDiv2(coeff[13], inp);
      hSrc7to8->delays[4] = inp;
      break;
    case 7:	
      hSrc7to8->mm++;
      dly1 = hSrc7to8->delays[5];
      decOut[14] = fMultDiv2(coeff[14], dly1);
      decOut[22] = fMultDiv2(coeff[22], dly1);
      decOut[30] = fMultDiv2(coeff[30], dly1);
      decOut[38] = fMultDiv2(coeff[38], dly1);
      decOut[46] = fMultDiv2(coeff[46], dly1);
      decOut[54] = fMultDiv2(coeff[54], dly1);
      decOut[6]  = fMultDiv2(coeff[6],  inp);
      hSrc7to8->delays[5] = inp;
      break;
    case 0:	
      hSrc7to8->mm++;
      decOut[7]  = fMultDiv2(coeff[7],  inp);
      decOut[15] = fMultDiv2(coeff[15], inp);
      decOut[23] = fMultDiv2(coeff[23], inp);
      decOut[31] = fMultDiv2(coeff[31], inp);
      decOut[39] = fMultDiv2(coeff[39], inp);
      decOut[47] = fMultDiv2(coeff[47], inp);
      decOut[55] = fMultDiv2(coeff[55], inp);
      break;

    default :
      return -1;
      break;
    }

    /* start upsampling by LL if decimation by MM is done */
    if (hSrc7to8->mm >= hSrc7to8->dnRatio){
      /* sum all decimated outputs and reset the switch */
      hSrc7to8->mm = 0;
      output[outCnt++ * stride] = (float) ((decOut[0]  + decOut[49] + decOut[42] + decOut[35] + decOut[28] + decOut[21] + decOut[14] + decOut[7] ) >> 15);
      output[outCnt++ * stride] = (float) ((decOut[8]  + decOut[1]  + decOut[50] + decOut[43] + decOut[36] + decOut[29] + decOut[22] + decOut[15]) >> 15);
      output[outCnt++ * stride] = (float) ((decOut[16] + decOut[9]  + decOut[2]  + decOut[51] + decOut[44] + decOut[37] + decOut[30] + decOut[23]) >> 15);
      output[outCnt++ * stride] = (float) ((decOut[24] + decOut[17] + decOut[10] + decOut[3]  + decOut[52] + decOut[45] + decOut[38] + decOut[31]) >> 15);
      output[outCnt++ * stride] = (float) ((decOut[32] + decOut[25] + decOut[18] + decOut[11] + decOut[4]  + decOut[53] + decOut[46] + decOut[39]) >> 15);
      output[outCnt++ * stride] = (float) ((decOut[40] + decOut[33] + decOut[26] + decOut[19] + decOut[12] + decOut[5]  + decOut[54] + decOut[47]) >> 15);
      output[outCnt++ * stride] = (float) ((decOut[48] + decOut[41] + decOut[34] + decOut[27] + decOut[20] + decOut[13] + decOut[6]  + decOut[55]) >> 15);
    }   /* if dnRatio */
  }     /* for length */

  return (outCnt);
}

int src6to5(  HANDLE_SRC hSrc6to5,
                  int16_t *input,
                  int16_t *output,
                  int     length,
                  int     stride)
{
  int i;
  int outCnt = 0;
  /* input sample */
  int16_t inp;
  register const float* coeff = hSrc6to5->filterCoeff;
  register int* decOut = hSrc6to5->decimationOutput;
  register float dly2;
  register float dly1;

  for (i = 0; i < length; i++) {
    /* decimation using polyphase filtering */
    inp = input[i*stride];
    switch (hSrc6to5->mm) {
    case 0:	
      hSrc6to5->mm++;
      dly1 = hSrc6to5->delays[0];
      decOut[10] = fMultDiv2(coeff[10], dly1);
      decOut[15] = fMultDiv2(coeff[15], dly1);
      decOut[20] = fMultDiv2(coeff[20], dly1);
      decOut[25] = fMultDiv2(coeff[25], dly1);
      decOut[0]  = fMultDiv2(coeff[0] , inp);
      decOut[5]  = fMultDiv2(coeff[5],  inp);
      hSrc6to5->delays[0] = inp;
      break;
    case 4:	
      hSrc6to5->mm++;
      dly2 = hSrc6to5->delays[1];
      dly1 = hSrc6to5->delays[2];
      decOut[16] = fMultDiv2(coeff[16], dly2);
      decOut[21] = fMultDiv2(coeff[21], dly2);
      decOut[26] = fMultDiv2(coeff[26], dly2);
      decOut[1]  = fMultDiv2(coeff[1],  dly1);
      decOut[6]  = fMultDiv2(coeff[6],  dly1);
      decOut[11] = fMultDiv2(coeff[11], dly1);
      hSrc6to5->delays[1] = hSrc6to5->delays[2]; 
      hSrc6to5->delays[2] = inp;
      break;
    case 3:	 
      hSrc6to5->mm++;
      dly2 = hSrc6to5->delays[3];
      dly1 = hSrc6to5->delays[4];
      decOut[22] = fMultDiv2(coeff[22], dly2);
      decOut[27] = fMultDiv2(coeff[27], dly2);
      decOut[2]  = fMultDiv2(coeff[2],  dly1);
      decOut[7]  = fMultDiv2(coeff[7],  dly1);
      decOut[12] = fMultDiv2(coeff[12], dly1);
      decOut[17] = fMultDiv2(coeff[17], dly1);
      hSrc6to5->delays[3] = hSrc6to5->delays[4]; 
      hSrc6to5->delays[4] = inp;
      break;
    case 2:	
      hSrc6to5->mm++;
      dly1 = hSrc6to5->delays[6];
      decOut[28] = fMultDiv2(coeff[28], hSrc6to5->delays[5]);
      decOut[3]  = fMultDiv2(coeff[3],  dly1);
      decOut[8]  = fMultDiv2(coeff[8],  dly1);
      decOut[13] = fMultDiv2(coeff[13], dly1);
      decOut[18] = fMultDiv2(coeff[18], dly1);
      decOut[23] = fMultDiv2(coeff[23], dly1);
      hSrc6to5->delays[5] = hSrc6to5->delays[6];
      hSrc6to5->delays[6] = inp;
      break;
    case 1:	
      hSrc6to5->mm++;
      dly1 = hSrc6to5->delays[7];
      decOut[4]  = fMultDiv2(coeff[4],  dly1);
      decOut[9]  = fMultDiv2(coeff[9],  dly1);
      decOut[14] = fMultDiv2(coeff[14], dly1);
      decOut[19] = fMultDiv2(coeff[19], dly1);
      decOut[24] = fMultDiv2(coeff[24], dly1);
      decOut[29] = fMultDiv2(coeff[29], dly1);
      hSrc6to5->delays[7] = inp;
      break;

    default :
      return -1;
      break;
    }

    /* start upsampling by LL if decimation by MM is done */
    if (hSrc6to5->mm >= hSrc6to5->dnRatio){
      /* sum all decimated outputs and reset the switch */
      hSrc6to5->mm = 0;
      output[outCnt++ * stride] = (float)((decOut[10] + decOut[16] + decOut[22] + decOut[28]  + decOut[4])  >> 15);
      output[outCnt++ * stride] = (float)((decOut[15] + decOut[21] + decOut[27] + decOut[3]   + decOut[9])  >> 15);
      output[outCnt++ * stride] = (float)((decOut[20] + decOut[26] + decOut[2]  + decOut[8]   + decOut[14]) >> 15);
      output[outCnt++ * stride] = (float)((decOut[25] + decOut[1]  + decOut[7]  + decOut[13]  + decOut[19]) >> 15);
      output[outCnt++ * stride] = (float)((decOut[0]  + decOut[6]  + decOut[12] + decOut[18]  + decOut[24]) >> 15);
      output[outCnt++ * stride] = (float)((decOut[5]  + decOut[11] + decOut[17] + decOut[23]  + decOut[29]) >> 15);
    }   /* if dnRatio */
  }     /* for length */

  return (outCnt);
}


#else /* USE_1_COEFFICIENTS */
#ifdef USE_2_COEFFICIENTS
#ifndef FUNCTION_src9to10
int src9to10(  HANDLE_SRC hSrc9to10,
                  int16_t *input,
                  int16_t *output,
                  int     length,
                  int     stride) 
{
  int i;
  int outCnt = 0;
  /* input sample */
  int16_t inp;
  float dly1;
  int* mm = &hSrc9to10->mm;
  float* states = hSrc9to10->states;
  float gain = hSrc9to10->gain;
  const float* coeff = hSrc9to10->filterCoeff;
  int* decOut = hSrc9to10->decimationOutput;

  for (i = 0; i < length; i++) {
    /* decimation using polyphase filtering */
    inp = input[i*stride];
    switch (hSrc9to10->mm) {
    case 0:
      (*mm)++;
      decOut[9]  = fir_filter2(&states[9*N_POLY_2],  &coeff[9*N_POLY_2] , inp);
      decOut[19] = fir_filter2(&states[19*N_POLY_2], &coeff[19*N_POLY_2], inp);
      decOut[29] = fir_filter2(&states[29*N_POLY_2], &coeff[29*N_POLY_2], inp);
      decOut[39] = fir_filter2(&states[39*N_POLY_2], &coeff[39*N_POLY_2], inp);
      decOut[49] = fir_filter2(&states[49*N_POLY_2], &coeff[49*N_POLY_2], inp);
      decOut[59] = fir_filter2(&states[59*N_POLY_2], &coeff[59*N_POLY_2], inp);
      decOut[69] = fir_filter2(&states[69*N_POLY_2], &coeff[69*N_POLY_2], inp);
      decOut[79] = fir_filter2(&states[79*N_POLY_2], &coeff[79*N_POLY_2], inp);
      decOut[89] = fir_filter2(&states[89*N_POLY_2], &coeff[89*N_POLY_2], inp);
      break;
    case 1:	
      (*mm)++;
      decOut[0]  = fir_filter2(&states[0]          , &coeff[0]          , inp);
      decOut[10] = fir_filter2(&states[10*N_POLY_2], &coeff[10*N_POLY_2], inp);
      decOut[20] = fir_filter2(&states[20*N_POLY_2], &coeff[20*N_POLY_2], inp);
      decOut[30] = fir_filter2(&states[30*N_POLY_2], &coeff[30*N_POLY_2], inp);
      decOut[40] = fir_filter2(&states[40*N_POLY_2], &coeff[40*N_POLY_2], inp);
      decOut[50] = fir_filter2(&states[50*N_POLY_2], &coeff[50*N_POLY_2], inp);
      decOut[60] = fir_filter2(&states[60*N_POLY_2], &coeff[60*N_POLY_2], inp);
      decOut[70] = fir_filter2(&states[70*N_POLY_2], &coeff[70*N_POLY_2], inp);
      decOut[80] = fir_filter2(&states[80*N_POLY_2], &coeff[80*N_POLY_2], inp);
      break;
    case 2:	
      (*mm)++;
      decOut[81] = fir_filter2(&states[81*N_POLY_2], &coeff[81*N_POLY_2], hSrc9to10->delays[0]);
      decOut[1]  = fir_filter2(&states[1*N_POLY_2],  &coeff[1*N_POLY_2] , inp);
      decOut[11] = fir_filter2(&states[11*N_POLY_2], &coeff[11*N_POLY_2], inp);
      decOut[21] = fir_filter2(&states[21*N_POLY_2], &coeff[21*N_POLY_2], inp);
      decOut[31] = fir_filter2(&states[31*N_POLY_2], &coeff[31*N_POLY_2], inp);
      decOut[41] = fir_filter2(&states[41*N_POLY_2], &coeff[41*N_POLY_2], inp);
      decOut[51] = fir_filter2(&states[51*N_POLY_2], &coeff[51*N_POLY_2], inp);
      decOut[61] = fir_filter2(&states[61*N_POLY_2], &coeff[61*N_POLY_2], inp);
      decOut[71] = fir_filter2(&states[71*N_POLY_2], &coeff[71*N_POLY_2], inp);
      hSrc9to10->delays[0] = inp;
      break;
    case 3:	
      (*mm)++;
      dly1 = hSrc9to10->delays[1];
      decOut[72] = fir_filter2(&states[72*N_POLY_2], &coeff[72*N_POLY_2], dly1);
      decOut[82] = fir_filter2(&states[82*N_POLY_2], &coeff[82*N_POLY_2], dly1);
      decOut[2]  = fir_filter2(&states[2*N_POLY_2],  &coeff[2*N_POLY_2] , inp);
      decOut[12] = fir_filter2(&states[12*N_POLY_2], &coeff[12*N_POLY_2], inp);
      decOut[22] = fir_filter2(&states[22*N_POLY_2], &coeff[22*N_POLY_2], inp);
      decOut[32] = fir_filter2(&states[32*N_POLY_2], &coeff[32*N_POLY_2], inp);
      decOut[42] = fir_filter2(&states[42*N_POLY_2], &coeff[42*N_POLY_2], inp);
      decOut[52] = fir_filter2(&states[52*N_POLY_2], &coeff[52*N_POLY_2], inp);
      decOut[62] = fir_filter2(&states[62*N_POLY_2], &coeff[62*N_POLY_2], inp);
      hSrc9to10->delays[1] = inp;
      break;
    case 4:	
      (*mm)++;
      dly1 = hSrc9to10->delays[2];
      decOut[63] = fir_filter2(&states[63*N_POLY_2], &coeff[63*N_POLY_2], dly1);
      decOut[73] = fir_filter2(&states[73*N_POLY_2], &coeff[73*N_POLY_2], dly1);
      decOut[83] = fir_filter2(&states[83*N_POLY_2], &coeff[83*N_POLY_2], dly1);
      decOut[3]  = fir_filter2(&states[3*N_POLY_2],  &coeff[3*N_POLY_2] , inp);
      decOut[13] = fir_filter2(&states[13*N_POLY_2], &coeff[13*N_POLY_2], inp);
      decOut[23] = fir_filter2(&states[23*N_POLY_2], &coeff[23*N_POLY_2], inp);
      decOut[33] = fir_filter2(&states[33*N_POLY_2], &coeff[33*N_POLY_2], inp);
      decOut[43] = fir_filter2(&states[43*N_POLY_2], &coeff[43*N_POLY_2], inp);
      decOut[53] = fir_filter2(&states[53*N_POLY_2], &coeff[53*N_POLY_2], inp);
      hSrc9to10->delays[2] = inp;
      break;
    case 5:	
      (*mm)++;
      dly1 = hSrc9to10->delays[3];
      decOut[54] = fir_filter2(&states[54*N_POLY_2], &coeff[54*N_POLY_2], dly1);
      decOut[64] = fir_filter2(&states[64*N_POLY_2], &coeff[64*N_POLY_2], dly1);
      decOut[74] = fir_filter2(&states[74*N_POLY_2], &coeff[74*N_POLY_2], dly1);
      decOut[84] = fir_filter2(&states[84*N_POLY_2], &coeff[84*N_POLY_2], dly1);
      decOut[4]  = fir_filter2(&states[4*N_POLY_2],  &coeff[4*N_POLY_2] , inp);
      decOut[14] = fir_filter2(&states[14*N_POLY_2], &coeff[14*N_POLY_2], inp);
      decOut[24] = fir_filter2(&states[24*N_POLY_2], &coeff[24*N_POLY_2], inp);
      decOut[34] = fir_filter2(&states[34*N_POLY_2], &coeff[34*N_POLY_2], inp);
      decOut[44] = fir_filter2(&states[44*N_POLY_2], &coeff[44*N_POLY_2], inp);
      hSrc9to10->delays[3] = inp;
      break;
    case 6:	
      (*mm)++;
      dly1 = hSrc9to10->delays[4];
      decOut[45] = fir_filter2(&states[45*N_POLY_2], &coeff[45*N_POLY_2], dly1);
      decOut[55] = fir_filter2(&states[55*N_POLY_2], &coeff[55*N_POLY_2], dly1);
      decOut[65] = fir_filter2(&states[65*N_POLY_2], &coeff[65*N_POLY_2], dly1);
      decOut[75] = fir_filter2(&states[75*N_POLY_2], &coeff[75*N_POLY_2], dly1);
      decOut[85] = fir_filter2(&states[85*N_POLY_2], &coeff[85*N_POLY_2], dly1);
      decOut[5]  = fir_filter2(&states[5*N_POLY_2],  &coeff[5*N_POLY_2] , inp);
      decOut[15] = fir_filter2(&states[15*N_POLY_2], &coeff[15*N_POLY_2], inp);
      decOut[25] = fir_filter2(&states[25*N_POLY_2], &coeff[25*N_POLY_2], inp);
      decOut[35] = fir_filter2(&states[35*N_POLY_2], &coeff[35*N_POLY_2], inp);
      hSrc9to10->delays[4] = inp;
      break;
    case 7:	
      (*mm)++;
      dly1 = hSrc9to10->delays[5];
      decOut[36] = fir_filter2(&states[36*N_POLY_2], &coeff[36*N_POLY_2], dly1);
      decOut[46] = fir_filter2(&states[46*N_POLY_2], &coeff[46*N_POLY_2], dly1);
      decOut[56] = fir_filter2(&states[56*N_POLY_2], &coeff[56*N_POLY_2], dly1);
      decOut[66] = fir_filter2(&states[66*N_POLY_2], &coeff[66*N_POLY_2], dly1);
      decOut[76] = fir_filter2(&states[76*N_POLY_2], &coeff[76*N_POLY_2], dly1);
      decOut[86] = fir_filter2(&states[86*N_POLY_2], &coeff[86*N_POLY_2], dly1);
      decOut[6]  = fir_filter2(&states[6*N_POLY_2],  &coeff[6*N_POLY_2] , inp);
      decOut[16] = fir_filter2(&states[16*N_POLY_2], &coeff[16*N_POLY_2], inp);
      decOut[26] = fir_filter2(&states[26*N_POLY_2], &coeff[26*N_POLY_2], inp);
      hSrc9to10->delays[5] = inp;
      break;
    case 8:	
      (*mm)++;
      dly1 = hSrc9to10->delays[6];
      decOut[27] = fir_filter2(&states[27*N_POLY_2], &coeff[27*N_POLY_2], dly1);
      decOut[37] = fir_filter2(&states[37*N_POLY_2], &coeff[37*N_POLY_2], dly1);
      decOut[47] = fir_filter2(&states[47*N_POLY_2], &coeff[47*N_POLY_2], dly1);
      decOut[57] = fir_filter2(&states[57*N_POLY_2], &coeff[57*N_POLY_2], dly1);
      decOut[67] = fir_filter2(&states[67*N_POLY_2], &coeff[67*N_POLY_2], dly1);
      decOut[77] = fir_filter2(&states[77*N_POLY_2], &coeff[77*N_POLY_2], dly1);
      decOut[87] = fir_filter2(&states[87*N_POLY_2], &coeff[87*N_POLY_2], dly1);
      decOut[7]  = fir_filter2(&states[7*N_POLY_2],  &coeff[7*N_POLY_2] , inp);
      decOut[17] = fir_filter2(&states[17*N_POLY_2], &coeff[17*N_POLY_2], inp);
      hSrc9to10->delays[6] = inp;
      break;
    case 9:	
      (*mm)++;
      dly1 = hSrc9to10->delays[7];
      decOut[18] = fir_filter2(&states[18*N_POLY_2], &coeff[18*N_POLY_2], dly1);
      decOut[28] = fir_filter2(&states[28*N_POLY_2], &coeff[28*N_POLY_2], dly1);
      decOut[38] = fir_filter2(&states[38*N_POLY_2], &coeff[38*N_POLY_2], dly1);
      decOut[48] = fir_filter2(&states[48*N_POLY_2], &coeff[48*N_POLY_2], dly1);
      decOut[58] = fir_filter2(&states[58*N_POLY_2], &coeff[58*N_POLY_2], dly1);
      decOut[68] = fir_filter2(&states[68*N_POLY_2], &coeff[68*N_POLY_2], dly1);
      decOut[78] = fir_filter2(&states[78*N_POLY_2], &coeff[78*N_POLY_2], dly1);
      decOut[88] = fir_filter2(&states[88*N_POLY_2], &coeff[88*N_POLY_2], dly1);
      decOut[8]  = fir_filter2(&states[8*N_POLY_2],  &coeff[8*N_POLY_2] , inp);
      hSrc9to10->delays[7] = inp;
      break;
    default :
      return -1;
      break;
    }

    /* start upsampling by LL if decimation by MM is done */
    if (hSrc9to10->mm >= hSrc9to10->dnRatio){
      /* sum all decimated outputs and reset the switch */
      hSrc9to10->mm = 0;
#ifdef SATURATE_TD_SRC_OUTPUT
      float tmp = (float)((decOut[0] + decOut[81] + decOut[72] + decOut[63] + decOut[54] + decOut[45] + decOut[36] + decOut[27] + decOut[18] + decOut[9]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE( gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[10] + decOut[1] + decOut[82] + decOut[73] + decOut[64] + decOut[55] + decOut[46] + decOut[37] + decOut[28] + decOut[19]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[20] + decOut[11] + decOut[2] + decOut[83] + decOut[74] + decOut[65] + decOut[56] + decOut[47] + decOut[38] + decOut[29]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[30] + decOut[21] + decOut[12] + decOut[3] + decOut[84] + decOut[75] + decOut[66] + decOut[57] + decOut[48] + decOut[39]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[40] + decOut[31] + decOut[22] + decOut[13] + decOut[4] + decOut[85] + decOut[76] + decOut[67] + decOut[58] + decOut[49]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[50] + decOut[41] + decOut[32] + decOut[23] + decOut[14] + decOut[5] + decOut[86] + decOut[77] + decOut[68] + decOut[59]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[60] + decOut[51] + decOut[42] + decOut[33] + decOut[24] + decOut[15] + decOut[6] + decOut[87] + decOut[78] + decOut[69]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[70] + decOut[61] + decOut[52] + decOut[43] + decOut[34] + decOut[25] + decOut[16] + decOut[7] + decOut[88] + decOut[79]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[80] + decOut[71] + decOut[62] + decOut[53] + decOut[44] + decOut[35] + decOut[26] + decOut[17] + decOut[8] + decOut[89]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
#else
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[0]  + decOut[81] + decOut[72] + decOut[63] + decOut[54] + decOut[45] + decOut[36] + decOut[27] + decOut[18] + decOut[9] ) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[10] + decOut[1]  + decOut[82] + decOut[73] + decOut[64] + decOut[55] + decOut[46] + decOut[37] + decOut[28] + decOut[19]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[20] + decOut[11] + decOut[2]  + decOut[83] + decOut[74] + decOut[65] + decOut[56] + decOut[47] + decOut[38] + decOut[29]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[30] + decOut[21] + decOut[12] + decOut[3]  + decOut[84] + decOut[75] + decOut[66] + decOut[57] + decOut[48] + decOut[39]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[40] + decOut[31] + decOut[22] + decOut[13] + decOut[4]  + decOut[85] + decOut[76] + decOut[67] + decOut[58] + decOut[49]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[50] + decOut[41] + decOut[32] + decOut[23] + decOut[14] + decOut[5]  + decOut[86] + decOut[77] + decOut[68] + decOut[59]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[60] + decOut[51] + decOut[42] + decOut[33] + decOut[24] + decOut[15] + decOut[6]  + decOut[87] + decOut[78] + decOut[69]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[70] + decOut[61] + decOut[52] + decOut[43] + decOut[34] + decOut[25] + decOut[16] + decOut[7]  + decOut[88] + decOut[79]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[80] + decOut[71] + decOut[62] + decOut[53] + decOut[44] + decOut[35] + decOut[26] + decOut[17] + decOut[8]  + decOut[89]) ));
#endif

    }   /* if dnRatio */
  }     /* for length */

  return (outCnt);
}
#endif
int src9to8(  HANDLE_SRC hSrc9to8,
                  int16_t *input,
                  int16_t *output,
                  int     length,
                  int     stride) 
{
  int i;
  int outCnt = 0;
  /* input sample */
  int16_t inp;
  register float* states = hSrc9to8->states;
  register const float* coeff = hSrc9to8->filterCoeff;
  float gain = hSrc9to8->gain;
  int* mm = &hSrc9to8->mm;
  register int* decOut = hSrc9to8->decimationOutput;
  register float dly2;
  register float dly1;

  for (i = 0; i < length; i++) {
    /* decimation using polyphase filtering */
    inp = input[i*stride];
    switch (hSrc9to8->mm) {
    case 0:	
      (*mm)++;
      dly1 = hSrc9to8->delays[0];
      decOut[16] = fir_filter2(&states[16*N_POLY_2], &coeff[16*N_POLY_2], dly1);
      decOut[24] = fir_filter2(&states[24*N_POLY_2], &coeff[24*N_POLY_2], dly1);
      decOut[32] = fir_filter2(&states[32*N_POLY_2], &coeff[32*N_POLY_2], dly1);
      decOut[40] = fir_filter2(&states[40*N_POLY_2], &coeff[40*N_POLY_2], dly1);
      decOut[48] = fir_filter2(&states[48*N_POLY_2], &coeff[48*N_POLY_2], dly1);
      decOut[56] = fir_filter2(&states[56*N_POLY_2], &coeff[56*N_POLY_2], dly1);
      decOut[64] = fir_filter2(&states[64*N_POLY_2], &coeff[64*N_POLY_2], dly1);
      decOut[0]  = fir_filter2(&states[0*N_POLY_2] , &coeff[0*N_POLY_2] ,  inp);
      decOut[8]  = fir_filter2(&states[8*N_POLY_2] , &coeff[8*N_POLY_2] ,  inp);
      hSrc9to8->delays[0] = inp;
      break;
    case 7:	
      (*mm)++;
      dly2 = hSrc9to8->delays[2];
      dly1 = hSrc9to8->delays[1];
      decOut[25] = fir_filter2(&states[25*N_POLY_2], &coeff[25*N_POLY_2], dly2);
      decOut[33] = fir_filter2(&states[33*N_POLY_2], &coeff[33*N_POLY_2], dly2);
      decOut[41] = fir_filter2(&states[41*N_POLY_2], &coeff[41*N_POLY_2], dly2);
      decOut[49] = fir_filter2(&states[49*N_POLY_2], &coeff[49*N_POLY_2], dly2);
      decOut[57] = fir_filter2(&states[57*N_POLY_2], &coeff[57*N_POLY_2], dly2);
      decOut[65] = fir_filter2(&states[65*N_POLY_2], &coeff[65*N_POLY_2], dly2);
      decOut[1]  = fir_filter2(&states[1*N_POLY_2] , &coeff[1*N_POLY_2] , dly1);
      decOut[9]  = fir_filter2(&states[9*N_POLY_2] , &coeff[9*N_POLY_2] , dly1);
      decOut[17] = fir_filter2(&states[17*N_POLY_2], &coeff[17*N_POLY_2], dly1);
      hSrc9to8->delays[2] = hSrc9to8->delays[1] ; 
      hSrc9to8->delays[1] = inp;
      break;
    case 6:	
      (*mm)++;
      dly2 = hSrc9to8->delays[4];
      dly1 = hSrc9to8->delays[3];
      decOut[34] = fir_filter2(&states[34*N_POLY_2], &coeff[34*N_POLY_2], dly2);
      decOut[42] = fir_filter2(&states[42*N_POLY_2], &coeff[42*N_POLY_2], dly2);
      decOut[50] = fir_filter2(&states[50*N_POLY_2], &coeff[50*N_POLY_2], dly2);
      decOut[58] = fir_filter2(&states[58*N_POLY_2], &coeff[58*N_POLY_2], dly2);
      decOut[66] = fir_filter2(&states[66*N_POLY_2], &coeff[66*N_POLY_2], dly2);
      decOut[2]  = fir_filter2(&states[2*N_POLY_2] , &coeff[2*N_POLY_2] , dly1);
      decOut[10] = fir_filter2(&states[10*N_POLY_2], &coeff[10*N_POLY_2], dly1);
      decOut[18] = fir_filter2(&states[18*N_POLY_2], &coeff[18*N_POLY_2], dly1);
      decOut[26] = fir_filter2(&states[26*N_POLY_2], &coeff[26*N_POLY_2], dly1);
      hSrc9to8->delays[4] = hSrc9to8->delays[3]; 
      hSrc9to8->delays[3] = inp;
      break;
    case 5:	
      (*mm)++;
      dly2 = hSrc9to8->delays[6];
      dly1 = hSrc9to8->delays[5];
      decOut[43] = fir_filter2(&states[43*N_POLY_2], &coeff[43*N_POLY_2], dly2);
      decOut[51] = fir_filter2(&states[51*N_POLY_2], &coeff[51*N_POLY_2], dly2);
      decOut[59] = fir_filter2(&states[59*N_POLY_2], &coeff[59*N_POLY_2], dly2);
      decOut[67] = fir_filter2(&states[67*N_POLY_2], &coeff[67*N_POLY_2], dly2);
      decOut[3]  = fir_filter2(&states[3*N_POLY_2] , &coeff[3*N_POLY_2] , dly1);
      decOut[11] = fir_filter2(&states[11*N_POLY_2], &coeff[11*N_POLY_2], dly1);
      decOut[19] = fir_filter2(&states[19*N_POLY_2], &coeff[19*N_POLY_2], dly1);
      decOut[27] = fir_filter2(&states[27*N_POLY_2], &coeff[27*N_POLY_2], dly1);
      decOut[35] = fir_filter2(&states[35*N_POLY_2], &coeff[35*N_POLY_2], dly1);
      hSrc9to8->delays[6] = hSrc9to8->delays[5]; 
      hSrc9to8->delays[5] = inp;
      break;
    case 4:	
      (*mm)++;
      dly2 = hSrc9to8->delays[8];
      dly1 = hSrc9to8->delays[7];
      decOut[52] = fir_filter2(&states[52*N_POLY_2], &coeff[52*N_POLY_2], dly2);
      decOut[60] = fir_filter2(&states[60*N_POLY_2], &coeff[60*N_POLY_2], dly2);
      decOut[68] = fir_filter2(&states[68*N_POLY_2], &coeff[68*N_POLY_2], dly2);
      decOut[4]  = fir_filter2(&states[4*N_POLY_2] , &coeff[4*N_POLY_2] , dly1);
      decOut[12] = fir_filter2(&states[12*N_POLY_2], &coeff[12*N_POLY_2], dly1);
      decOut[20] = fir_filter2(&states[20*N_POLY_2], &coeff[20*N_POLY_2], dly1);
      decOut[28] = fir_filter2(&states[28*N_POLY_2], &coeff[28*N_POLY_2], dly1);
      decOut[36] = fir_filter2(&states[36*N_POLY_2], &coeff[36*N_POLY_2], dly1);
      decOut[44] = fir_filter2(&states[44*N_POLY_2], &coeff[44*N_POLY_2], dly1);
      hSrc9to8->delays[8] = hSrc9to8->delays[7] ; 
      hSrc9to8->delays[7] = inp;
      break;
    case 3:	
      (*mm)++;
      dly2 = hSrc9to8->delays[10];
      dly1 = hSrc9to8->delays[9];
      decOut[61] = fir_filter2(&states[61*N_POLY_2], &coeff[61*N_POLY_2], dly2);
      decOut[69] = fir_filter2(&states[69*N_POLY_2], &coeff[69*N_POLY_2], dly2);
      decOut[5]  = fir_filter2(&states[5*N_POLY_2] , &coeff[5*N_POLY_2] , dly1);
      decOut[13] = fir_filter2(&states[13*N_POLY_2], &coeff[13*N_POLY_2], dly1);
      decOut[21] = fir_filter2(&states[21*N_POLY_2], &coeff[21*N_POLY_2], dly1);
      decOut[29] = fir_filter2(&states[29*N_POLY_2], &coeff[29*N_POLY_2], dly1);
      decOut[37] = fir_filter2(&states[37*N_POLY_2], &coeff[37*N_POLY_2], dly1);
      decOut[45] = fir_filter2(&states[45*N_POLY_2], &coeff[45*N_POLY_2], dly1);
      decOut[53] = fir_filter2(&states[53*N_POLY_2], &coeff[53*N_POLY_2], dly1);
      hSrc9to8->delays[10] = hSrc9to8->delays[9] ; 
      hSrc9to8->delays[9] = inp;
      break;
    case 2:	
      (*mm)++;
      dly1 = hSrc9to8->delays[11];
      decOut[70] = fir_filter2(&states[70*N_POLY_2], &coeff[70*N_POLY_2], hSrc9to8->delays[12]);
      decOut[6]  = fir_filter2(&states[6*N_POLY_2] , &coeff[6*N_POLY_2] , dly1);
      decOut[14] = fir_filter2(&states[14*N_POLY_2], &coeff[14*N_POLY_2], dly1);
      decOut[22] = fir_filter2(&states[22*N_POLY_2], &coeff[22*N_POLY_2], dly1);
      decOut[30] = fir_filter2(&states[30*N_POLY_2], &coeff[30*N_POLY_2], dly1);
      decOut[38] = fir_filter2(&states[38*N_POLY_2], &coeff[38*N_POLY_2], dly1);
      decOut[46] = fir_filter2(&states[46*N_POLY_2], &coeff[46*N_POLY_2], dly1);
      decOut[54] = fir_filter2(&states[54*N_POLY_2], &coeff[54*N_POLY_2], dly1);
      decOut[62] = fir_filter2(&states[62*N_POLY_2], &coeff[62*N_POLY_2], dly1);
      hSrc9to8->delays[12] = hSrc9to8->delays[11];
      hSrc9to8->delays[11] = inp;
      break;
    case 1:	
      (*mm)++;
      dly1 = hSrc9to8->delays[13];
      decOut[7]  = fir_filter2(&states[7*N_POLY_2] , &coeff[7*N_POLY_2] , dly1);
      decOut[15] = fir_filter2(&states[15*N_POLY_2], &coeff[15*N_POLY_2], dly1);
      decOut[23] = fir_filter2(&states[23*N_POLY_2], &coeff[23*N_POLY_2], dly1);
      decOut[31] = fir_filter2(&states[31*N_POLY_2], &coeff[31*N_POLY_2], dly1);
      decOut[39] = fir_filter2(&states[39*N_POLY_2], &coeff[39*N_POLY_2], dly1);
      decOut[47] = fir_filter2(&states[47*N_POLY_2], &coeff[47*N_POLY_2], dly1);
      decOut[55] = fir_filter2(&states[55*N_POLY_2], &coeff[55*N_POLY_2], dly1);
      decOut[63] = fir_filter2(&states[63*N_POLY_2], &coeff[63*N_POLY_2], dly1);
      decOut[71] = fir_filter2(&states[71*N_POLY_2], &coeff[71*N_POLY_2], dly1);
      hSrc9to8->delays[13] = inp;
      break;

    default :
      return -1;
      break;
    }

    /* start upsampling by LL if decimation by MM is done */
    if (hSrc9to8->mm >= hSrc9to8->dnRatio){
      /* sum all decimated outputs and reset the switch */
      hSrc9to8->mm = 0;
#ifdef SATURATE_TD_SRC_OUTPUT
      float tmp = (float)((decOut[16] + decOut[25] + decOut[34] + decOut[43] + decOut[52] + decOut[61] + decOut[70] + decOut[7]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE( gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[24] + decOut[33] + decOut[42] + decOut[51] + decOut[60] + decOut[69] + decOut[6]  + decOut[15]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[32] + decOut[41] + decOut[50] + decOut[59] + decOut[68] + decOut[5]  + decOut[14] + decOut[23]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[40] + decOut[49] + decOut[58] + decOut[67] + decOut[4]  + decOut[13] + decOut[22] + decOut[31]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[48] + decOut[57] + decOut[66] + decOut[3]  + decOut[12] + decOut[21] + decOut[30] + decOut[39]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[56] + decOut[65] + decOut[2]  + decOut[11] + decOut[20] + decOut[29] + decOut[38] + decOut[47]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[64] + decOut[1]  + decOut[10] + decOut[19] + decOut[28] + decOut[37] + decOut[46] + decOut[55]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[0]  + decOut[9]  + decOut[18] + decOut[27] + decOut[36] + decOut[45] + decOut[54] + decOut[63]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[8]  + decOut[17] + decOut[26] + decOut[35] + decOut[44] + decOut[53] + decOut[62] + decOut[71]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
#else
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[16] + decOut[25] + decOut[34] + decOut[43] + decOut[52] + decOut[61] + decOut[70] + decOut[7] ) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[24] + decOut[33] + decOut[42] + decOut[51] + decOut[60] + decOut[69] + decOut[6]  + decOut[15]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[32] + decOut[41] + decOut[50] + decOut[59] + decOut[68] + decOut[5]  + decOut[14] + decOut[23]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[40] + decOut[49] + decOut[58] + decOut[67] + decOut[4]  + decOut[13] + decOut[22] + decOut[31]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[48] + decOut[57] + decOut[66] + decOut[3]  + decOut[12] + decOut[21] + decOut[30] + decOut[39]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[56] + decOut[65] + decOut[2]  + decOut[11] + decOut[20] + decOut[29] + decOut[38] + decOut[47]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[64] + decOut[1]  + decOut[10] + decOut[19] + decOut[28] + decOut[37] + decOut[46] + decOut[55]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[0]  + decOut[9]  + decOut[18] + decOut[27] + decOut[36] + decOut[45] + decOut[54] + decOut[63]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[8]  + decOut[17] + decOut[26] + decOut[35] + decOut[44] + decOut[53] + decOut[62] + decOut[71]) ));
#endif
    }   /* if dnRatio */
  }     /* for length */

  return (outCnt);
}


int src7to8(  HANDLE_SRC hSrc7to8,
                  int16_t *input,
                  int16_t *output,
                  int     length,
                  int     stride) 
{
  int i, outCnt = 0;
  /* input sample */
  int16_t inp;
  register float* states = hSrc7to8->states;
  float gain = hSrc7to8->gain;
  int *mm = &hSrc7to8->mm;
  register const float* coeff = hSrc7to8->filterCoeff;
  register int* decOut = hSrc7to8->decimationOutput;
  register float dly1;

  for (i = 0; i < length; i++) {
    /* decimation using polyphase filtering */
    inp = input[i*stride];
    switch (hSrc7to8->mm) {
    case 1:	
      (*mm)++;
      decOut[0]  = fir_filter2(&states[0]         ,  &coeff[0]         ,  inp);
      decOut[8]  = fir_filter2(&states[8*N_POLY_2],  &coeff[8*N_POLY_2],  inp);
      decOut[16] = fir_filter2(&states[16*N_POLY_2], &coeff[16*N_POLY_2], inp);
      decOut[24] = fir_filter2(&states[24*N_POLY_2], &coeff[24*N_POLY_2], inp);
      decOut[32] = fir_filter2(&states[32*N_POLY_2], &coeff[32*N_POLY_2], inp);
      decOut[40] = fir_filter2(&states[40*N_POLY_2], &coeff[40*N_POLY_2], inp);
      decOut[48] = fir_filter2(&states[48*N_POLY_2], &coeff[48*N_POLY_2], inp);
      break;
    case 2:	
      (*mm)++;
      decOut[49] = fir_filter2(&states[49*N_POLY_2], &coeff[49*N_POLY_2], hSrc7to8->delays[0]);
      decOut[1]  = fir_filter2(&states[1*N_POLY_2],  &coeff[1*N_POLY_2],  inp);
      decOut[9]  = fir_filter2(&states[9*N_POLY_2],  &coeff[9*N_POLY_2],  inp);
      decOut[17] = fir_filter2(&states[17*N_POLY_2], &coeff[17*N_POLY_2], inp);
      decOut[25] = fir_filter2(&states[25*N_POLY_2], &coeff[25*N_POLY_2], inp);
      decOut[33] = fir_filter2(&states[33*N_POLY_2], &coeff[33*N_POLY_2], inp);
      decOut[41] = fir_filter2(&states[41*N_POLY_2], &coeff[41*N_POLY_2], inp);
      hSrc7to8->delays[0] = inp;
      break;
    case 3:	
      (*mm)++;
      dly1 = hSrc7to8->delays[1];
      decOut[42] = fir_filter2(&states[42*N_POLY_2], &coeff[42*N_POLY_2], dly1);
      decOut[50] = fir_filter2(&states[50*N_POLY_2], &coeff[50*N_POLY_2], dly1);
      decOut[2]  = fir_filter2(&states[2*N_POLY_2],  &coeff[2*N_POLY_2],  inp);
      decOut[10] = fir_filter2(&states[10*N_POLY_2], &coeff[10*N_POLY_2], inp);
      decOut[18] = fir_filter2(&states[18*N_POLY_2], &coeff[18*N_POLY_2], inp);
      decOut[26] = fir_filter2(&states[26*N_POLY_2], &coeff[26*N_POLY_2], inp);
      decOut[34] = fir_filter2(&states[34*N_POLY_2], &coeff[34*N_POLY_2], inp);
      hSrc7to8->delays[1] = inp;
      break;
    case 4:	
      (*mm)++;
      dly1 = hSrc7to8->delays[2];
      decOut[35] = fir_filter2(&states[35*N_POLY_2], &coeff[35*N_POLY_2], dly1);
      decOut[43] = fir_filter2(&states[43*N_POLY_2], &coeff[43*N_POLY_2], dly1);
      decOut[51] = fir_filter2(&states[51*N_POLY_2], &coeff[51*N_POLY_2], dly1);
      decOut[3]  = fir_filter2(&states[3*N_POLY_2],  &coeff[3*N_POLY_2],  inp);
      decOut[11] = fir_filter2(&states[11*N_POLY_2], &coeff[11*N_POLY_2], inp);
      decOut[19] = fir_filter2(&states[19*N_POLY_2], &coeff[19*N_POLY_2], inp);
      decOut[27] = fir_filter2(&states[27*N_POLY_2], &coeff[27*N_POLY_2], inp);
      hSrc7to8->delays[2] = inp;
      break;
    case 5:	
      (*mm)++;
      dly1 = hSrc7to8->delays[3];
      decOut[28] = fir_filter2(&states[28*N_POLY_2], &coeff[28*N_POLY_2], dly1);
      decOut[36] = fir_filter2(&states[36*N_POLY_2], &coeff[36*N_POLY_2], dly1);
      decOut[44] = fir_filter2(&states[44*N_POLY_2], &coeff[44*N_POLY_2], dly1);
      decOut[52] = fir_filter2(&states[52*N_POLY_2], &coeff[52*N_POLY_2], dly1);
      decOut[4]  = fir_filter2(&states[4*N_POLY_2],  &coeff[4*N_POLY_2],  inp);
      decOut[12] = fir_filter2(&states[12*N_POLY_2], &coeff[12*N_POLY_2], inp);
      decOut[20] = fir_filter2(&states[20*N_POLY_2], &coeff[20*N_POLY_2], inp);
      hSrc7to8->delays[3] = inp;
      break;
    case 6:	
      (*mm)++;
      dly1 = hSrc7to8->delays[4];
      decOut[21] = fir_filter2(&states[21*N_POLY_2], &coeff[21*N_POLY_2], dly1);
      decOut[29] = fir_filter2(&states[29*N_POLY_2], &coeff[29*N_POLY_2], dly1);
      decOut[37] = fir_filter2(&states[37*N_POLY_2], &coeff[37*N_POLY_2], dly1);
      decOut[45] = fir_filter2(&states[45*N_POLY_2], &coeff[45*N_POLY_2], dly1);
      decOut[53] = fir_filter2(&states[53*N_POLY_2], &coeff[53*N_POLY_2], dly1);
      decOut[5]  = fir_filter2(&states[5*N_POLY_2],  &coeff[5*N_POLY_2],  inp);
      decOut[13] = fir_filter2(&states[13*N_POLY_2], &coeff[13*N_POLY_2], inp);
      hSrc7to8->delays[4] = inp;
      break;
    case 7:	
      (*mm)++;
      dly1 = hSrc7to8->delays[5];
      decOut[14] = fir_filter2(&states[14*N_POLY_2], &coeff[14*N_POLY_2], dly1);
      decOut[22] = fir_filter2(&states[22*N_POLY_2], &coeff[22*N_POLY_2], dly1);
      decOut[30] = fir_filter2(&states[30*N_POLY_2], &coeff[30*N_POLY_2], dly1);
      decOut[38] = fir_filter2(&states[38*N_POLY_2], &coeff[38*N_POLY_2], dly1);
      decOut[46] = fir_filter2(&states[46*N_POLY_2], &coeff[46*N_POLY_2], dly1);
      decOut[54] = fir_filter2(&states[54*N_POLY_2], &coeff[54*N_POLY_2], dly1);
      decOut[6]  = fir_filter2(&states[6*N_POLY_2],  &coeff[6*N_POLY_2],  inp);
      hSrc7to8->delays[5] = inp;
      break;
    case 0:	
      (*mm)++;
      decOut[7]  = fir_filter2(&states[7*N_POLY_2],  &coeff[7*N_POLY_2],  inp);
      decOut[15] = fir_filter2(&states[15*N_POLY_2], &coeff[15*N_POLY_2], inp);
      decOut[23] = fir_filter2(&states[23*N_POLY_2], &coeff[23*N_POLY_2], inp);
      decOut[31] = fir_filter2(&states[31*N_POLY_2], &coeff[31*N_POLY_2], inp);
      decOut[39] = fir_filter2(&states[39*N_POLY_2], &coeff[39*N_POLY_2], inp);
      decOut[47] = fir_filter2(&states[47*N_POLY_2], &coeff[47*N_POLY_2], inp);
      decOut[55] = fir_filter2(&states[55*N_POLY_2], &coeff[55*N_POLY_2], inp);
      break;

    default :
      return -1;
      break;
    }

    /* start upsampling by LL if decimation by MM is done */
    if (hSrc7to8->mm >= hSrc7to8->dnRatio){
      /* sum all decimated outputs and reset the switch */
      hSrc7to8->mm = 0;
#ifdef SATURATE_TD_SRC_OUTPUT
      float tmp = (float)((decOut[0]  + decOut[49] + decOut[42] + decOut[35] + decOut[28] + decOut[21] + decOut[14] + decOut[7]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE( gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[8]  + decOut[1]  + decOut[50] + decOut[43] + decOut[36] + decOut[29] + decOut[22] + decOut[15]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[16] + decOut[9]  + decOut[2]  + decOut[51] + decOut[44] + decOut[37] + decOut[30] + decOut[23]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[24] + decOut[17] + decOut[10] + decOut[3]  + decOut[52] + decOut[45] + decOut[38] + decOut[31]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[32] + decOut[25] + decOut[18] + decOut[11] + decOut[4]  + decOut[53] + decOut[46] + decOut[39]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[40] + decOut[33] + decOut[26] + decOut[19] + decOut[12] + decOut[5]  + decOut[54] + decOut[47]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[48] + decOut[41] + decOut[34] + decOut[27] + decOut[20] + decOut[13] + decOut[6]  + decOut[55]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
#else
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[0]  + decOut[49] + decOut[42] + decOut[35] + decOut[28] + decOut[21] + decOut[14] + decOut[7] ) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[8]  + decOut[1]  + decOut[50] + decOut[43] + decOut[36] + decOut[29] + decOut[22] + decOut[15]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[16] + decOut[9]  + decOut[2]  + decOut[51] + decOut[44] + decOut[37] + decOut[30] + decOut[23]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[24] + decOut[17] + decOut[10] + decOut[3]  + decOut[52] + decOut[45] + decOut[38] + decOut[31]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[32] + decOut[25] + decOut[18] + decOut[11] + decOut[4]  + decOut[53] + decOut[46] + decOut[39]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[40] + decOut[33] + decOut[26] + decOut[19] + decOut[12] + decOut[5]  + decOut[54] + decOut[47]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[48] + decOut[41] + decOut[34] + decOut[27] + decOut[20] + decOut[13] + decOut[6]  + decOut[55]) ));
#endif
    }   /* if dnRatio */
  }     /* for length */

  return (outCnt);
}

int src6to5(  HANDLE_SRC hSrc6to5,
                  int16_t *input,
                  int16_t *output,
                  int     length,
                  int     stride) 
{
  int i;
  int outCnt = 0;
  /* input sample */
  int16_t inp;
  register float* states = hSrc6to5->states;
  register const float* coeff = hSrc6to5->filterCoeff;
  float gain = hSrc6to5->gain;
  int *mm = &hSrc6to5->mm;
  register int* decOut = hSrc6to5->decimationOutput;
  register float dly2;
  register float dly1;

  for (i = 0; i < length; i++) {
    /* decimation using polyphase filtering */
    inp = input[i*stride];
    switch (hSrc6to5->mm) {
    case 0:	
      (*mm)++;
      dly1 = hSrc6to5->delays[0];
      decOut[10] = fir_filter2(&states[10*N_POLY_2], &coeff[10*N_POLY_2], dly1);
      decOut[15] = fir_filter2(&states[15*N_POLY_2], &coeff[15*N_POLY_2], dly1);
      decOut[20] = fir_filter2(&states[20*N_POLY_2], &coeff[20*N_POLY_2], dly1);
      decOut[25] = fir_filter2(&states[25*N_POLY_2], &coeff[25*N_POLY_2], dly1);
      decOut[0]  = fir_filter2(&states[0]          , &coeff[0]          , inp);
      decOut[5]  = fir_filter2(&states[5*N_POLY_2],  &coeff[5*N_POLY_2] , inp);
      hSrc6to5->delays[0] = inp;
      break;
    case 4:	
      (*mm)++;
      dly2 = hSrc6to5->delays[1];
      dly1 = hSrc6to5->delays[2];
      decOut[16] = fir_filter2(&states[16*N_POLY_2], &coeff[16*N_POLY_2], dly2);
      decOut[21] = fir_filter2(&states[21*N_POLY_2], &coeff[21*N_POLY_2], dly2);
      decOut[26] = fir_filter2(&states[26*N_POLY_2], &coeff[26*N_POLY_2], dly2);
      decOut[1]  = fir_filter2(&states[1*N_POLY_2],  &coeff[1*N_POLY_2],  dly1);
      decOut[6]  = fir_filter2(&states[6*N_POLY_2],  &coeff[6*N_POLY_2],  dly1);
      decOut[11] = fir_filter2(&states[11*N_POLY_2], &coeff[11*N_POLY_2], dly1);
      hSrc6to5->delays[1] = hSrc6to5->delays[2]; 
      hSrc6to5->delays[2] = inp;
      break;
    case 3:	 
      (*mm)++;
      dly2 = hSrc6to5->delays[3];
      dly1 = hSrc6to5->delays[4];
      decOut[22] = fir_filter2(&states[22*N_POLY_2], &coeff[22*N_POLY_2], dly2);
      decOut[27] = fir_filter2(&states[27*N_POLY_2], &coeff[27*N_POLY_2], dly2);
      decOut[2]  = fir_filter2(&states[2*N_POLY_2],  &coeff[2*N_POLY_2],  dly1);
      decOut[7]  = fir_filter2(&states[7*N_POLY_2],  &coeff[7*N_POLY_2],  dly1);
      decOut[12] = fir_filter2(&states[12*N_POLY_2], &coeff[12*N_POLY_2], dly1);
      decOut[17] = fir_filter2(&states[17*N_POLY_2], &coeff[17*N_POLY_2], dly1);
      hSrc6to5->delays[3] = hSrc6to5->delays[4]; 
      hSrc6to5->delays[4] = inp;
      break;
    case 2:	
      (*mm)++;
      dly1 = hSrc6to5->delays[6];
      decOut[28] = fir_filter2(&states[28*N_POLY_2], &coeff[28*N_POLY_2], hSrc6to5->delays[5]);
      decOut[3]  = fir_filter2(&states[3*N_POLY_2],  &coeff[3*N_POLY_2],  dly1);
      decOut[8]  = fir_filter2(&states[8*N_POLY_2],  &coeff[8*N_POLY_2],  dly1);
      decOut[13] = fir_filter2(&states[13*N_POLY_2], &coeff[13*N_POLY_2], dly1);
      decOut[18] = fir_filter2(&states[18*N_POLY_2], &coeff[18*N_POLY_2], dly1);
      decOut[23] = fir_filter2(&states[23*N_POLY_2], &coeff[23*N_POLY_2], dly1);
      hSrc6to5->delays[5] = hSrc6to5->delays[6];
      hSrc6to5->delays[6] = inp;
      break;
    case 1:	
      (*mm)++;
      dly1 = hSrc6to5->delays[7];
      decOut[4]  = fir_filter2(&states[4*N_POLY_2],  &coeff[4*N_POLY_2],  dly1);
      decOut[9]  = fir_filter2(&states[9*N_POLY_2],  &coeff[9*N_POLY_2],  dly1);
      decOut[14] = fir_filter2(&states[14*N_POLY_2], &coeff[14*N_POLY_2], dly1);
      decOut[19] = fir_filter2(&states[19*N_POLY_2], &coeff[19*N_POLY_2], dly1);
      decOut[24] = fir_filter2(&states[24*N_POLY_2], &coeff[24*N_POLY_2], dly1);
      decOut[29] = fir_filter2(&states[29*N_POLY_2], &coeff[29*N_POLY_2], dly1);
      hSrc6to5->delays[7] = inp;
      break;

    default :
      return -1;
      break;
    }

    /* start upsampling by LL if decimation by MM is done */
    if (hSrc6to5->mm >= hSrc6to5->dnRatio){
      /* sum all decimated outputs and reset the switch */
      hSrc6to5->mm = 0;
#ifdef SATURATE_TD_SRC_OUTPUT
      float tmp = (float)((decOut[10] + decOut[16] + decOut[22] + decOut[28]  + decOut[4]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE( gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[15] + decOut[21] + decOut[27] + decOut[3]   + decOut[9]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[20] + decOut[26] + decOut[2]  + decOut[8]   + decOut[14]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[25] + decOut[1]  + decOut[7]  + decOut[13]  + decOut[19]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[0]  + decOut[6]  + decOut[12] + decOut[18]  + decOut[24]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[5]  + decOut[11] + decOut[17] + decOut[23]  + decOut[29]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
#else
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[10] + decOut[16] + decOut[22] + decOut[28]  + decOut[4])  ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[15] + decOut[21] + decOut[27] + decOut[3]   + decOut[9])  ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[20] + decOut[26] + decOut[2]  + decOut[8]   + decOut[14]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[25] + decOut[1]  + decOut[7]  + decOut[13]  + decOut[19]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[0]  + decOut[6]  + decOut[12] + decOut[18]  + decOut[24]) ));
      output[outCnt++ * stride] = (float)(gain*(float)((decOut[5]  + decOut[11] + decOut[17] + decOut[23]  + decOut[29]) ));
#endif
    }   /* if dnRatio */
  }     /* for length */

  return (outCnt);
}

#else  /* USE_2_COEFFICIENTS */
#ifdef USE_3_COEFFICIENTS

#ifndef FUNCTION_src9to10
int src9to10(  HANDLE_SRC hSrc9to10,
                  int16_t *input,
                  int16_t *output,
                  int     length,
                  int     stride)
{
  int i;
  int outCnt = 0;
  /* input sample */
  int16_t inp;
  float dly1;
  int* mm = &hSrc9to10->mm;
  float* states = hSrc9to10->states;
  float gain = hSrc9to10->gain;
  const float* coeff = hSrc9to10->filterCoeff;
  int* decOut = hSrc9to10->decimationOutput;

  for (i = 0; i < length; i++) {
    /* decimation using polyphase filtering */
    inp = input[i*stride];
    switch (*mm) {
    case 0:
      (*mm)++;
      decOut[9]  = fir_filter3(&states[9*N_POLY_3],  &coeff[9*N_POLY_3] , inp);
      decOut[19] = fir_filter3(&states[19*N_POLY_3], &coeff[19*N_POLY_3], inp);
      decOut[29] = fir_filter3(&states[29*N_POLY_3], &coeff[29*N_POLY_3], inp);
      decOut[39] = fir_filter3(&states[39*N_POLY_3], &coeff[39*N_POLY_3], inp);
      decOut[49] = fir_filter3(&states[49*N_POLY_3], &coeff[49*N_POLY_3], inp);
      decOut[59] = fir_filter3(&states[59*N_POLY_3], &coeff[59*N_POLY_3], inp);
      decOut[69] = fir_filter3(&states[69*N_POLY_3], &coeff[69*N_POLY_3], inp);
      decOut[79] = fir_filter3(&states[79*N_POLY_3], &coeff[79*N_POLY_3], inp);
      decOut[89] = fir_filter3(&states[89*N_POLY_3], &coeff[89*N_POLY_3], inp);
      break;
    case 1:
      (*mm)++;
      decOut[0]  = fir_filter3(&states[0]          , &coeff[0]          , inp);
      decOut[10] = fir_filter3(&states[10*N_POLY_3], &coeff[10*N_POLY_3], inp);
      decOut[20] = fir_filter3(&states[20*N_POLY_3], &coeff[20*N_POLY_3], inp);
      decOut[30] = fir_filter3(&states[30*N_POLY_3], &coeff[30*N_POLY_3], inp);
      decOut[40] = fir_filter3(&states[40*N_POLY_3], &coeff[40*N_POLY_3], inp);
      decOut[50] = fir_filter3(&states[50*N_POLY_3], &coeff[50*N_POLY_3], inp);
      decOut[60] = fir_filter3(&states[60*N_POLY_3], &coeff[60*N_POLY_3], inp);
      decOut[70] = fir_filter3(&states[70*N_POLY_3], &coeff[70*N_POLY_3], inp);
      decOut[80] = fir_filter3(&states[80*N_POLY_3], &coeff[80*N_POLY_3], inp);
      break;
    case 2:
      (*mm)++;
      dly1 = hSrc9to10->delays[0];
      decOut[81] = fir_filter3(&states[81*N_POLY_3], &coeff[81*N_POLY_3], dly1);
      decOut[1]  = fir_filter3(&states[1*N_POLY_3],  &coeff[1*N_POLY_3] , inp);
      decOut[11] = fir_filter3(&states[11*N_POLY_3], &coeff[11*N_POLY_3], inp);
      decOut[21] = fir_filter3(&states[21*N_POLY_3], &coeff[21*N_POLY_3], inp);
      decOut[31] = fir_filter3(&states[31*N_POLY_3], &coeff[31*N_POLY_3], inp);
      decOut[41] = fir_filter3(&states[41*N_POLY_3], &coeff[41*N_POLY_3], inp);
      decOut[51] = fir_filter3(&states[51*N_POLY_3], &coeff[51*N_POLY_3], inp);
      decOut[61] = fir_filter3(&states[61*N_POLY_3], &coeff[61*N_POLY_3], inp);
      decOut[71] = fir_filter3(&states[71*N_POLY_3], &coeff[71*N_POLY_3], inp);
      hSrc9to10->delays[0] = inp;
      break;
    case 3:
      (*mm)++;
      dly1 = hSrc9to10->delays[1];
      decOut[72] = fir_filter3(&states[72*N_POLY_3], &coeff[72*N_POLY_3], dly1);
      decOut[82] = fir_filter3(&states[82*N_POLY_3], &coeff[82*N_POLY_3], dly1);
      decOut[2]  = fir_filter3(&states[2*N_POLY_3],  &coeff[2*N_POLY_3] , inp);
      decOut[12] = fir_filter3(&states[12*N_POLY_3], &coeff[12*N_POLY_3], inp);
      decOut[22] = fir_filter3(&states[22*N_POLY_3], &coeff[22*N_POLY_3], inp);
      decOut[32] = fir_filter3(&states[32*N_POLY_3], &coeff[32*N_POLY_3], inp);
      decOut[42] = fir_filter3(&states[42*N_POLY_3], &coeff[42*N_POLY_3], inp);
      decOut[52] = fir_filter3(&states[52*N_POLY_3], &coeff[52*N_POLY_3], inp);
      decOut[62] = fir_filter3(&states[62*N_POLY_3], &coeff[62*N_POLY_3], inp);
      hSrc9to10->delays[1] = inp;
      break;
    case 4:
      (*mm)++;
      dly1 = hSrc9to10->delays[2];
      decOut[63] = fir_filter3(&states[63*N_POLY_3], &coeff[63*N_POLY_3], dly1);
      decOut[73] = fir_filter3(&states[73*N_POLY_3], &coeff[73*N_POLY_3], dly1);
      decOut[83] = fir_filter3(&states[83*N_POLY_3], &coeff[83*N_POLY_3], dly1);
      decOut[3]  = fir_filter3(&states[3*N_POLY_3],  &coeff[3*N_POLY_3] , inp);
      decOut[13] = fir_filter3(&states[13*N_POLY_3], &coeff[13*N_POLY_3], inp);
      decOut[23] = fir_filter3(&states[23*N_POLY_3], &coeff[23*N_POLY_3], inp);
      decOut[33] = fir_filter3(&states[33*N_POLY_3], &coeff[33*N_POLY_3], inp);
      decOut[43] = fir_filter3(&states[43*N_POLY_3], &coeff[43*N_POLY_3], inp);
      decOut[53] = fir_filter3(&states[53*N_POLY_3], &coeff[53*N_POLY_3], inp);
      hSrc9to10->delays[2] = inp;
      break;
    case 5:
      (*mm)++;
      dly1 = hSrc9to10->delays[3];
      decOut[54] = fir_filter3(&states[54*N_POLY_3], &coeff[54*N_POLY_3], dly1);
      decOut[64] = fir_filter3(&states[64*N_POLY_3], &coeff[64*N_POLY_3], dly1);
      decOut[74] = fir_filter3(&states[74*N_POLY_3], &coeff[74*N_POLY_3], dly1);
      decOut[84] = fir_filter3(&states[84*N_POLY_3], &coeff[84*N_POLY_3], dly1);
      decOut[4]  = fir_filter3(&states[4*N_POLY_3],  &coeff[4*N_POLY_3] , inp);
      decOut[14] = fir_filter3(&states[14*N_POLY_3], &coeff[14*N_POLY_3], inp);
      decOut[24] = fir_filter3(&states[24*N_POLY_3], &coeff[24*N_POLY_3], inp);
      decOut[34] = fir_filter3(&states[34*N_POLY_3], &coeff[34*N_POLY_3], inp);
      decOut[44] = fir_filter3(&states[44*N_POLY_3], &coeff[44*N_POLY_3], inp);
      hSrc9to10->delays[3] = inp;
      break;
    case 6:
      (*mm)++;
      dly1 = hSrc9to10->delays[4];
      decOut[45] = fir_filter3(&states[45*N_POLY_3], &coeff[45*N_POLY_3], dly1);
      decOut[55] = fir_filter3(&states[55*N_POLY_3], &coeff[55*N_POLY_3], dly1);
      decOut[65] = fir_filter3(&states[65*N_POLY_3], &coeff[65*N_POLY_3], dly1);
      decOut[75] = fir_filter3(&states[75*N_POLY_3], &coeff[75*N_POLY_3], dly1);
      decOut[85] = fir_filter3(&states[85*N_POLY_3], &coeff[85*N_POLY_3], dly1);
      decOut[5]  = fir_filter3(&states[5*N_POLY_3],  &coeff[5*N_POLY_3] , inp);
      decOut[15] = fir_filter3(&states[15*N_POLY_3], &coeff[15*N_POLY_3], inp);
      decOut[25] = fir_filter3(&states[25*N_POLY_3], &coeff[25*N_POLY_3], inp);
      decOut[35] = fir_filter3(&states[35*N_POLY_3], &coeff[35*N_POLY_3], inp);
      hSrc9to10->delays[4] = inp;
      break;
    case 7:
      (*mm)++;
      dly1 = hSrc9to10->delays[5];
      decOut[36] = fir_filter3(&states[36*N_POLY_3], &coeff[36*N_POLY_3], dly1);
      decOut[46] = fir_filter3(&states[46*N_POLY_3], &coeff[46*N_POLY_3], dly1);
      decOut[56] = fir_filter3(&states[56*N_POLY_3], &coeff[56*N_POLY_3], dly1);
      decOut[66] = fir_filter3(&states[66*N_POLY_3], &coeff[66*N_POLY_3], dly1);
      decOut[76] = fir_filter3(&states[76*N_POLY_3], &coeff[76*N_POLY_3], dly1);
      decOut[86] = fir_filter3(&states[86*N_POLY_3], &coeff[86*N_POLY_3], dly1);
      decOut[6]  = fir_filter3(&states[6*N_POLY_3],  &coeff[6*N_POLY_3] , inp);
      decOut[16] = fir_filter3(&states[16*N_POLY_3], &coeff[16*N_POLY_3], inp);
      decOut[26] = fir_filter3(&states[26*N_POLY_3], &coeff[26*N_POLY_3], inp);
      hSrc9to10->delays[5] = inp;
      break;
    case 8:
      (*mm)++;
      dly1 = hSrc9to10->delays[6];
      decOut[27] = fir_filter3(&states[27*N_POLY_3], &coeff[27*N_POLY_3], dly1);
      decOut[37] = fir_filter3(&states[37*N_POLY_3], &coeff[37*N_POLY_3], dly1);
      decOut[47] = fir_filter3(&states[47*N_POLY_3], &coeff[47*N_POLY_3], dly1);
      decOut[57] = fir_filter3(&states[57*N_POLY_3], &coeff[57*N_POLY_3], dly1);
      decOut[67] = fir_filter3(&states[67*N_POLY_3], &coeff[67*N_POLY_3], dly1);
      decOut[77] = fir_filter3(&states[77*N_POLY_3], &coeff[77*N_POLY_3], dly1);
      decOut[87] = fir_filter3(&states[87*N_POLY_3], &coeff[87*N_POLY_3], dly1);
      decOut[7]  = fir_filter3(&states[7*N_POLY_3],  &coeff[7*N_POLY_3] , inp);
      decOut[17] = fir_filter3(&states[17*N_POLY_3], &coeff[17*N_POLY_3], inp);
      hSrc9to10->delays[6] = inp;
      break;
    case 9:
      (*mm)++;
      dly1 = hSrc9to10->delays[7];
      decOut[18] = fir_filter3(&states[18*N_POLY_3], &coeff[18*N_POLY_3], dly1);
      decOut[28] = fir_filter3(&states[28*N_POLY_3], &coeff[28*N_POLY_3], dly1);
      decOut[38] = fir_filter3(&states[38*N_POLY_3], &coeff[38*N_POLY_3], dly1);
      decOut[48] = fir_filter3(&states[48*N_POLY_3], &coeff[48*N_POLY_3], dly1);
      decOut[58] = fir_filter3(&states[58*N_POLY_3], &coeff[58*N_POLY_3], dly1);
      decOut[68] = fir_filter3(&states[68*N_POLY_3], &coeff[68*N_POLY_3], dly1);
      decOut[78] = fir_filter3(&states[78*N_POLY_3], &coeff[78*N_POLY_3], dly1);
      decOut[88] = fir_filter3(&states[88*N_POLY_3], &coeff[88*N_POLY_3], dly1);
      decOut[8]  = fir_filter3(&states[8*N_POLY_3],  &coeff[8*N_POLY_3] , inp);
      hSrc9to10->delays[7] = inp;
      break;
    default :
      return -1;
      break;
    }

    /* start upsampling by LL if decimation by mm is done */
    if (*mm >= hSrc9to10->dnRatio){
      /* sum all decimated outputs and reset the switch */
      *mm = 0; 
#ifdef SATURATE_TD_SRC_OUTPUT
      float tmp = (float)((decOut[0] + decOut[81] + decOut[72] + decOut[63] + decOut[54] + decOut[45] + decOut[36] + decOut[27] + decOut[18] + decOut[9]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE( gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[10] + decOut[1] + decOut[82] + decOut[73] + decOut[64] + decOut[55] + decOut[46] + decOut[37] + decOut[28] + decOut[19]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[20] + decOut[11] + decOut[2] + decOut[83] + decOut[74] + decOut[65] + decOut[56] + decOut[47] + decOut[38] + decOut[29]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[30] + decOut[21] + decOut[12] + decOut[3] + decOut[84] + decOut[75] + decOut[66] + decOut[57] + decOut[48] + decOut[39]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[40] + decOut[31] + decOut[22] + decOut[13] + decOut[4] + decOut[85] + decOut[76] + decOut[67] + decOut[58] + decOut[49]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[50] + decOut[41] + decOut[32] + decOut[23] + decOut[14] + decOut[5] + decOut[86] + decOut[77] + decOut[68] + decOut[59]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[60] + decOut[51] + decOut[42] + decOut[33] + decOut[24] + decOut[15] + decOut[6] + decOut[87] + decOut[78] + decOut[69]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[70] + decOut[61] + decOut[52] + decOut[43] + decOut[34] + decOut[25] + decOut[16] + decOut[7] + decOut[88] + decOut[79]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[80] + decOut[71] + decOut[62] + decOut[53] + decOut[44] + decOut[35] + decOut[26] + decOut[17] + decOut[8] + decOut[89]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
#else
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[0]  + decOut[81] + decOut[72] + decOut[63] + decOut[54] + decOut[45] + decOut[36] + decOut[27] + decOut[18] + decOut[9] ) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[10] + decOut[1]  + decOut[82] + decOut[73] + decOut[64] + decOut[55] + decOut[46] + decOut[37] + decOut[28] + decOut[19]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[20] + decOut[11] + decOut[2]  + decOut[83] + decOut[74] + decOut[65] + decOut[56] + decOut[47] + decOut[38] + decOut[29]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[30] + decOut[21] + decOut[12] + decOut[3]  + decOut[84] + decOut[75] + decOut[66] + decOut[57] + decOut[48] + decOut[39]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[40] + decOut[31] + decOut[22] + decOut[13] + decOut[4]  + decOut[85] + decOut[76] + decOut[67] + decOut[58] + decOut[49]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[50] + decOut[41] + decOut[32] + decOut[23] + decOut[14] + decOut[5]  + decOut[86] + decOut[77] + decOut[68] + decOut[59]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[60] + decOut[51] + decOut[42] + decOut[33] + decOut[24] + decOut[15] + decOut[6]  + decOut[87] + decOut[78] + decOut[69]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[70] + decOut[61] + decOut[52] + decOut[43] + decOut[34] + decOut[25] + decOut[16] + decOut[7]  + decOut[88] + decOut[79]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[80] + decOut[71] + decOut[62] + decOut[53] + decOut[44] + decOut[35] + decOut[26] + decOut[17] + decOut[8]  + decOut[89]) >> 15));
#endif
    }   /* if dnRatio */
  }     /* for length */

  return (outCnt);
}
#endif /* ifndef(FUNCTION_src9to10) */

int src9to8(  HANDLE_SRC hSrc9to8,
                  int16_t *input,
                  int16_t *output,
                  int     length,
                  int     stride) 
{
  int i;
  int outCnt = 0;
  /* input sample */
  int16_t inp;
  register float* states = hSrc9to8->states;
  register const float* coeff = hSrc9to8->filterCoeff;
  float gain = hSrc9to8->gain;
  int* mm = &hSrc9to8->mm;
  register int* decOut = hSrc9to8->decimationOutput;
  register float dly2;
  register float dly1;

  for (i = 0; i < length; i++) {
    /* decimation using polyphase filtering */
    inp = input[i*stride];
    switch (hSrc9to8->mm) {
    case 0:
      (*mm)++;
      dly1 = hSrc9to8->delays[0];
      decOut[16] = fir_filter2(&states[16*N_POLY_2], &coeff[16*N_POLY_2], dly1);
      decOut[24] = fir_filter2(&states[24*N_POLY_2], &coeff[24*N_POLY_2], dly1);
      decOut[32] = fir_filter2(&states[32*N_POLY_2], &coeff[32*N_POLY_2], dly1);
      decOut[40] = fir_filter2(&states[40*N_POLY_2], &coeff[40*N_POLY_2], dly1);
      decOut[48] = fir_filter2(&states[48*N_POLY_2], &coeff[48*N_POLY_2], dly1);
      decOut[56] = fir_filter2(&states[56*N_POLY_2], &coeff[56*N_POLY_2], dly1);
      decOut[64] = fir_filter2(&states[64*N_POLY_2], &coeff[64*N_POLY_2], dly1);
      decOut[0]  = fir_filter2(&states[0*N_POLY_2] , &coeff[0*N_POLY_2] ,  inp);
      decOut[8]  = fir_filter2(&states[8*N_POLY_2] , &coeff[8*N_POLY_2] ,  inp);
      hSrc9to8->delays[0] = inp;
      break;
    case 7:
      (*mm)++;
      dly2 = hSrc9to8->delays[2];
      dly1 = hSrc9to8->delays[1];
      decOut[25] = fir_filter2(&states[25*N_POLY_2], &coeff[25*N_POLY_2], dly2);
      decOut[33] = fir_filter2(&states[33*N_POLY_2], &coeff[33*N_POLY_2], dly2);
      decOut[41] = fir_filter2(&states[41*N_POLY_2], &coeff[41*N_POLY_2], dly2);
      decOut[49] = fir_filter2(&states[49*N_POLY_2], &coeff[49*N_POLY_2], dly2);
      decOut[57] = fir_filter2(&states[57*N_POLY_2], &coeff[57*N_POLY_2], dly2);
      decOut[65] = fir_filter2(&states[65*N_POLY_2], &coeff[65*N_POLY_2], dly2);
      decOut[1]  = fir_filter2(&states[1*N_POLY_2] , &coeff[1*N_POLY_2] , dly1);
      decOut[9]  = fir_filter2(&states[9*N_POLY_2] , &coeff[9*N_POLY_2] , dly1);
      decOut[17] = fir_filter2(&states[17*N_POLY_2], &coeff[17*N_POLY_2], dly1);
      hSrc9to8->delays[2] = hSrc9to8->delays[1] ; 
      hSrc9to8->delays[1] = inp;
      break;
    case 6:
      (*mm)++;
      dly2 = hSrc9to8->delays[4];
      dly1 = hSrc9to8->delays[3];
      decOut[34] = fir_filter2(&states[34*N_POLY_2], &coeff[34*N_POLY_2], dly2);
      decOut[42] = fir_filter2(&states[42*N_POLY_2], &coeff[42*N_POLY_2], dly2);
      decOut[50] = fir_filter2(&states[50*N_POLY_2], &coeff[50*N_POLY_2], dly2);
      decOut[58] = fir_filter2(&states[58*N_POLY_2], &coeff[58*N_POLY_2], dly2);
      decOut[66] = fir_filter2(&states[66*N_POLY_2], &coeff[66*N_POLY_2], dly2);
      decOut[2]  = fir_filter2(&states[2*N_POLY_2] , &coeff[2*N_POLY_2] , dly1);
      decOut[10] = fir_filter2(&states[10*N_POLY_2], &coeff[10*N_POLY_2], dly1);
      decOut[18] = fir_filter2(&states[18*N_POLY_2], &coeff[18*N_POLY_2], dly1);
      decOut[26] = fir_filter2(&states[26*N_POLY_2], &coeff[26*N_POLY_2], dly1);
      hSrc9to8->delays[4] = hSrc9to8->delays[3]; 
      hSrc9to8->delays[3] = inp;
      break;
    case 5:
      (*mm)++;
      dly2 = hSrc9to8->delays[6];
      dly1 = hSrc9to8->delays[5];
      decOut[43] = fir_filter2(&states[43*N_POLY_2], &coeff[43*N_POLY_2], dly2);
      decOut[51] = fir_filter2(&states[51*N_POLY_2], &coeff[51*N_POLY_2], dly2);
      decOut[59] = fir_filter2(&states[59*N_POLY_2], &coeff[59*N_POLY_2], dly2);
      decOut[67] = fir_filter2(&states[67*N_POLY_2], &coeff[67*N_POLY_2], dly2);
      decOut[3]  = fir_filter2(&states[3*N_POLY_2] , &coeff[3*N_POLY_2] , dly1);
      decOut[11] = fir_filter2(&states[11*N_POLY_2], &coeff[11*N_POLY_2], dly1);
      decOut[19] = fir_filter2(&states[19*N_POLY_2], &coeff[19*N_POLY_2], dly1);
      decOut[27] = fir_filter2(&states[27*N_POLY_2], &coeff[27*N_POLY_2], dly1);
      decOut[35] = fir_filter2(&states[35*N_POLY_2], &coeff[35*N_POLY_2], dly1);
      hSrc9to8->delays[6] = hSrc9to8->delays[5]; 
      hSrc9to8->delays[5] = inp;
      break;
    case 4:
      (*mm)++;
      dly2 = hSrc9to8->delays[8];
      dly1 = hSrc9to8->delays[7];
      decOut[52] = fir_filter2(&states[52*N_POLY_2], &coeff[52*N_POLY_2], dly2);
      decOut[60] = fir_filter2(&states[60*N_POLY_2], &coeff[60*N_POLY_2], dly2);
      decOut[68] = fir_filter2(&states[68*N_POLY_2], &coeff[68*N_POLY_2], dly2);
      decOut[4]  = fir_filter2(&states[4*N_POLY_2] , &coeff[4*N_POLY_2] , dly1);
      decOut[12] = fir_filter2(&states[12*N_POLY_2], &coeff[12*N_POLY_2], dly1);
      decOut[20] = fir_filter2(&states[20*N_POLY_2], &coeff[20*N_POLY_2], dly1);
      decOut[28] = fir_filter2(&states[28*N_POLY_2], &coeff[28*N_POLY_2], dly1);
      decOut[36] = fir_filter2(&states[36*N_POLY_2], &coeff[36*N_POLY_2], dly1);
      decOut[44] = fir_filter2(&states[44*N_POLY_2], &coeff[44*N_POLY_2], dly1);
      hSrc9to8->delays[8] = hSrc9to8->delays[7] ; 
      hSrc9to8->delays[7] = inp;
      break;
    case 3:
      (*mm)++;
      dly2 = hSrc9to8->delays[10];
      dly1 = hSrc9to8->delays[9];
      decOut[61] = fir_filter2(&states[61*N_POLY_2], &coeff[61*N_POLY_2], dly2);
      decOut[69] = fir_filter2(&states[69*N_POLY_2], &coeff[69*N_POLY_2], dly2);
      decOut[5]  = fir_filter2(&states[5*N_POLY_2] , &coeff[5*N_POLY_2] , dly1);
      decOut[13] = fir_filter2(&states[13*N_POLY_2], &coeff[13*N_POLY_2], dly1);
      decOut[21] = fir_filter2(&states[21*N_POLY_2], &coeff[21*N_POLY_2], dly1);
      decOut[29] = fir_filter2(&states[29*N_POLY_2], &coeff[29*N_POLY_2], dly1);
      decOut[37] = fir_filter2(&states[37*N_POLY_2], &coeff[37*N_POLY_2], dly1);
      decOut[45] = fir_filter2(&states[45*N_POLY_2], &coeff[45*N_POLY_2], dly1);
      decOut[53] = fir_filter2(&states[53*N_POLY_2], &coeff[53*N_POLY_2], dly1);
      hSrc9to8->delays[10] = hSrc9to8->delays[9] ; 
      hSrc9to8->delays[9] = inp;
      break;
    case 2:
      (*mm)++;
      dly1 = hSrc9to8->delays[11];
      decOut[70] = fir_filter2(&states[70*N_POLY_2], &coeff[70*N_POLY_2], hSrc9to8->delays[12]);
      decOut[6]  = fir_filter2(&states[6*N_POLY_2] , &coeff[6*N_POLY_2] , dly1);
      decOut[14] = fir_filter2(&states[14*N_POLY_2], &coeff[14*N_POLY_2], dly1);
      decOut[22] = fir_filter2(&states[22*N_POLY_2], &coeff[22*N_POLY_2], dly1);
      decOut[30] = fir_filter2(&states[30*N_POLY_2], &coeff[30*N_POLY_2], dly1);
      decOut[38] = fir_filter2(&states[38*N_POLY_2], &coeff[38*N_POLY_2], dly1);
      decOut[46] = fir_filter2(&states[46*N_POLY_2], &coeff[46*N_POLY_2], dly1);
      decOut[54] = fir_filter2(&states[54*N_POLY_2], &coeff[54*N_POLY_2], dly1);
      decOut[62] = fir_filter2(&states[62*N_POLY_2], &coeff[62*N_POLY_2], dly1);
      hSrc9to8->delays[12] = hSrc9to8->delays[11];
      hSrc9to8->delays[11] = inp;
      break;
    case 1:
      (*mm)++;
      dly1 = hSrc9to8->delays[13];
      decOut[7]  = fir_filter2(&states[7*N_POLY_2] , &coeff[7*N_POLY_2] , dly1);
      decOut[15] = fir_filter2(&states[15*N_POLY_2], &coeff[15*N_POLY_2], dly1);
      decOut[23] = fir_filter2(&states[23*N_POLY_2], &coeff[23*N_POLY_2], dly1);
      decOut[31] = fir_filter2(&states[31*N_POLY_2], &coeff[31*N_POLY_2], dly1);
      decOut[39] = fir_filter2(&states[39*N_POLY_2], &coeff[39*N_POLY_2], dly1);
      decOut[47] = fir_filter2(&states[47*N_POLY_2], &coeff[47*N_POLY_2], dly1);
      decOut[55] = fir_filter2(&states[55*N_POLY_2], &coeff[55*N_POLY_2], dly1);
      decOut[63] = fir_filter2(&states[63*N_POLY_2], &coeff[63*N_POLY_2], dly1);
      decOut[71] = fir_filter2(&states[71*N_POLY_2], &coeff[71*N_POLY_2], dly1);
      hSrc9to8->delays[13] = inp;
      break;

    default :
      return -1;
      break;
    }

    /* start upsampling by LL if decimation by MM is done */
    if (hSrc9to8->mm >= hSrc9to8->dnRatio){
      /* sum all decimated outputs and reset the switch */
      hSrc9to8->mm = 0;
#ifdef SATURATE_TD_SRC_OUTPUT
      float tmp = (float)((decOut[16] + decOut[25] + decOut[34] + decOut[43] + decOut[52] + decOut[61] + decOut[70] + decOut[7]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE( gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[24] + decOut[33] + decOut[42] + decOut[51] + decOut[60] + decOut[69] + decOut[6]  + decOut[15]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[32] + decOut[41] + decOut[50] + decOut[59] + decOut[68] + decOut[5]  + decOut[14] + decOut[23]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[40] + decOut[49] + decOut[58] + decOut[67] + decOut[4]  + decOut[13] + decOut[22] + decOut[31]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[48] + decOut[57] + decOut[66] + decOut[3]  + decOut[12] + decOut[21] + decOut[30] + decOut[39]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[56] + decOut[65] + decOut[2]  + decOut[11] + decOut[20] + decOut[29] + decOut[38] + decOut[47]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[64] + decOut[1]  + decOut[10] + decOut[19] + decOut[28] + decOut[37] + decOut[46] + decOut[55]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[0]  + decOut[9]  + decOut[18] + decOut[27] + decOut[36] + decOut[45] + decOut[54] + decOut[63]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[8]  + decOut[17] + decOut[26] + decOut[35] + decOut[44] + decOut[53] + decOut[62] + decOut[71]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
#else
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[16] + decOut[25] + decOut[34] + decOut[43] + decOut[52] + decOut[61] + decOut[70] + decOut[7] ) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[24] + decOut[33] + decOut[42] + decOut[51] + decOut[60] + decOut[69] + decOut[6]  + decOut[15]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[32] + decOut[41] + decOut[50] + decOut[59] + decOut[68] + decOut[5]  + decOut[14] + decOut[23]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[40] + decOut[49] + decOut[58] + decOut[67] + decOut[4]  + decOut[13] + decOut[22] + decOut[31]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[48] + decOut[57] + decOut[66] + decOut[3]  + decOut[12] + decOut[21] + decOut[30] + decOut[39]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[56] + decOut[65] + decOut[2]  + decOut[11] + decOut[20] + decOut[29] + decOut[38] + decOut[47]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[64] + decOut[1]  + decOut[10] + decOut[19] + decOut[28] + decOut[37] + decOut[46] + decOut[55]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[0]  + decOut[9]  + decOut[18] + decOut[27] + decOut[36] + decOut[45] + decOut[54] + decOut[63]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[8]  + decOut[17] + decOut[26] + decOut[35] + decOut[44] + decOut[53] + decOut[62] + decOut[71]) >> 15));
#endif
    }   /* if dnRatio */
  }     /* for length */

  return (outCnt);
}

int src7to8(  HANDLE_SRC hSrc7to8,
                  int16_t *input,
                  int16_t *output,
                  int     length,
                  int     stride) 
{
  int i, outCnt = 0;
  /* input sample */
  int16_t inp;
  register float* states = hSrc7to8->states;
  float gain = hSrc7to8->gain;
  int *mm = &hSrc7to8->mm;
  register const float* coeff = hSrc7to8->filterCoeff;
  register int* decOut = hSrc7to8->decimationOutput;
  register float dly1;

  for (i = 0; i < length; i++) {
    /* decimation using polyphase filtering */
    inp = input[i*stride];
    switch (hSrc7to8->mm) {
    case 1:	
      (*mm)++;
      decOut[0]  = fir_filter3(&states[0]         ,  &coeff[0]         ,  inp);
      decOut[8]  = fir_filter3(&states[8*N_POLY_3],  &coeff[8*N_POLY_3],  inp);
      decOut[16] = fir_filter3(&states[16*N_POLY_3], &coeff[16*N_POLY_3], inp);
      decOut[24] = fir_filter3(&states[24*N_POLY_3], &coeff[24*N_POLY_3], inp);
      decOut[32] = fir_filter3(&states[32*N_POLY_3], &coeff[32*N_POLY_3], inp);
      decOut[40] = fir_filter3(&states[40*N_POLY_3], &coeff[40*N_POLY_3], inp);
      decOut[48] = fir_filter3(&states[48*N_POLY_3], &coeff[48*N_POLY_3], inp);
      break;
    case 2:	
      (*mm)++;
      decOut[49] = fir_filter3(&states[49*N_POLY_3], &coeff[49*N_POLY_3], hSrc7to8->delays[0]);
      decOut[1]  = fir_filter3(&states[1*N_POLY_3],  &coeff[1*N_POLY_3],  inp);
      decOut[9]  = fir_filter3(&states[9*N_POLY_3],  &coeff[9*N_POLY_3],  inp);
      decOut[17] = fir_filter3(&states[17*N_POLY_3], &coeff[17*N_POLY_3], inp);
      decOut[25] = fir_filter3(&states[25*N_POLY_3], &coeff[25*N_POLY_3], inp);
      decOut[33] = fir_filter3(&states[33*N_POLY_3], &coeff[33*N_POLY_3], inp);
      decOut[41] = fir_filter3(&states[41*N_POLY_3], &coeff[41*N_POLY_3], inp);
      hSrc7to8->delays[0] = inp;
      break;
    case 3:	
      (*mm)++;
      dly1 = hSrc7to8->delays[1];
      decOut[42] = fir_filter3(&states[42*N_POLY_3], &coeff[42*N_POLY_3], dly1);
      decOut[50] = fir_filter3(&states[50*N_POLY_3], &coeff[50*N_POLY_3], dly1);
      decOut[2]  = fir_filter3(&states[2*N_POLY_3],  &coeff[2*N_POLY_3],  inp);
      decOut[10] = fir_filter3(&states[10*N_POLY_3], &coeff[10*N_POLY_3], inp);
      decOut[18] = fir_filter3(&states[18*N_POLY_3], &coeff[18*N_POLY_3], inp);
      decOut[26] = fir_filter3(&states[26*N_POLY_3], &coeff[26*N_POLY_3], inp);
      decOut[34] = fir_filter3(&states[34*N_POLY_3], &coeff[34*N_POLY_3], inp);
      hSrc7to8->delays[1] = inp;
      break;
    case 4:	
      (*mm)++;
      dly1 = hSrc7to8->delays[2];
      decOut[35] = fir_filter3(&states[35*N_POLY_3], &coeff[35*N_POLY_3], dly1);
      decOut[43] = fir_filter3(&states[43*N_POLY_3], &coeff[43*N_POLY_3], dly1);
      decOut[51] = fir_filter3(&states[51*N_POLY_3], &coeff[51*N_POLY_3], dly1);
      decOut[3]  = fir_filter3(&states[3*N_POLY_3],  &coeff[3*N_POLY_3],  inp);
      decOut[11] = fir_filter3(&states[11*N_POLY_3], &coeff[11*N_POLY_3], inp);
      decOut[19] = fir_filter3(&states[19*N_POLY_3], &coeff[19*N_POLY_3], inp);
      decOut[27] = fir_filter3(&states[27*N_POLY_3], &coeff[27*N_POLY_3], inp);
      hSrc7to8->delays[2] = inp;
      break;
    case 5:	
      (*mm)++;
      dly1 = hSrc7to8->delays[3];
      decOut[28] = fir_filter3(&states[28*N_POLY_3], &coeff[28*N_POLY_3], dly1);
      decOut[36] = fir_filter3(&states[36*N_POLY_3], &coeff[36*N_POLY_3], dly1);
      decOut[44] = fir_filter3(&states[44*N_POLY_3], &coeff[44*N_POLY_3], dly1);
      decOut[52] = fir_filter3(&states[52*N_POLY_3], &coeff[52*N_POLY_3], dly1);
      decOut[4]  = fir_filter3(&states[4*N_POLY_3],  &coeff[4*N_POLY_3],  inp);
      decOut[12] = fir_filter3(&states[12*N_POLY_3], &coeff[12*N_POLY_3], inp);
      decOut[20] = fir_filter3(&states[20*N_POLY_3], &coeff[20*N_POLY_3], inp);
      hSrc7to8->delays[3] = inp;
      break;
    case 6:	
      (*mm)++;
      dly1 = hSrc7to8->delays[4];
      decOut[21] = fir_filter3(&states[21*N_POLY_3], &coeff[21*N_POLY_3], dly1);
      decOut[29] = fir_filter3(&states[29*N_POLY_3], &coeff[29*N_POLY_3], dly1);
      decOut[37] = fir_filter3(&states[37*N_POLY_3], &coeff[37*N_POLY_3], dly1);
      decOut[45] = fir_filter3(&states[45*N_POLY_3], &coeff[45*N_POLY_3], dly1);
      decOut[53] = fir_filter3(&states[53*N_POLY_3], &coeff[53*N_POLY_3], dly1);
      decOut[5]  = fir_filter3(&states[5*N_POLY_3],  &coeff[5*N_POLY_3],  inp);
      decOut[13] = fir_filter3(&states[13*N_POLY_3], &coeff[13*N_POLY_3], inp);
      hSrc7to8->delays[4] = inp;
      break;
    case 7:	
      (*mm)++;
      dly1 = hSrc7to8->delays[5];
      decOut[14] = fir_filter3(&states[14*N_POLY_3], &coeff[14*N_POLY_3], dly1);
      decOut[22] = fir_filter3(&states[22*N_POLY_3], &coeff[22*N_POLY_3], dly1);
      decOut[30] = fir_filter3(&states[30*N_POLY_3], &coeff[30*N_POLY_3], dly1);
      decOut[38] = fir_filter3(&states[38*N_POLY_3], &coeff[38*N_POLY_3], dly1);
      decOut[46] = fir_filter3(&states[46*N_POLY_3], &coeff[46*N_POLY_3], dly1);
      decOut[54] = fir_filter3(&states[54*N_POLY_3], &coeff[54*N_POLY_3], dly1);
      decOut[6]  = fir_filter3(&states[6*N_POLY_3],  &coeff[6*N_POLY_3],  inp);
      hSrc7to8->delays[5] = inp;
      break;
    case 0:	
      (*mm)++;
      decOut[7]  = fir_filter3(&states[7*N_POLY_3],  &coeff[7*N_POLY_3],  inp);
      decOut[15] = fir_filter3(&states[15*N_POLY_3], &coeff[15*N_POLY_3], inp);
      decOut[23] = fir_filter3(&states[23*N_POLY_3], &coeff[23*N_POLY_3], inp);
      decOut[31] = fir_filter3(&states[31*N_POLY_3], &coeff[31*N_POLY_3], inp);
      decOut[39] = fir_filter3(&states[39*N_POLY_3], &coeff[39*N_POLY_3], inp);
      decOut[47] = fir_filter3(&states[47*N_POLY_3], &coeff[47*N_POLY_3], inp);
      decOut[55] = fir_filter3(&states[55*N_POLY_3], &coeff[55*N_POLY_3], inp);
      break;

    default :
      return -1;
      break;
    }

    /* start upsampling by LL if decimation by MM is done */
    if (hSrc7to8->mm >= hSrc7to8->dnRatio){
      /* sum all decimated outputs and reset the switch */
      hSrc7to8->mm = 0;
#ifdef SATURATE_TD_SRC_OUTPUT
      float tmp = (float)((decOut[0]  + decOut[49] + decOut[42] + decOut[35] + decOut[28] + decOut[21] + decOut[14] + decOut[7]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE( gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[8]  + decOut[1]  + decOut[50] + decOut[43] + decOut[36] + decOut[29] + decOut[22] + decOut[15]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[16] + decOut[9]  + decOut[2]  + decOut[51] + decOut[44] + decOut[37] + decOut[30] + decOut[23]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[24] + decOut[17] + decOut[10] + decOut[3]  + decOut[52] + decOut[45] + decOut[38] + decOut[31]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[32] + decOut[25] + decOut[18] + decOut[11] + decOut[4]  + decOut[53] + decOut[46] + decOut[39]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[40] + decOut[33] + decOut[26] + decOut[19] + decOut[12] + decOut[5]  + decOut[54] + decOut[47]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[48] + decOut[41] + decOut[34] + decOut[27] + decOut[20] + decOut[13] + decOut[6]  + decOut[55]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
#else
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[0]  + decOut[49] + decOut[42] + decOut[35] + decOut[28] + decOut[21] + decOut[14] + decOut[7] ) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[8]  + decOut[1]  + decOut[50] + decOut[43] + decOut[36] + decOut[29] + decOut[22] + decOut[15]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[16] + decOut[9]  + decOut[2]  + decOut[51] + decOut[44] + decOut[37] + decOut[30] + decOut[23]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[24] + decOut[17] + decOut[10] + decOut[3]  + decOut[52] + decOut[45] + decOut[38] + decOut[31]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[32] + decOut[25] + decOut[18] + decOut[11] + decOut[4]  + decOut[53] + decOut[46] + decOut[39]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[40] + decOut[33] + decOut[26] + decOut[19] + decOut[12] + decOut[5]  + decOut[54] + decOut[47]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[48] + decOut[41] + decOut[34] + decOut[27] + decOut[20] + decOut[13] + decOut[6]  + decOut[55]) >> 15));
#endif
    }   /* if dnRatio */
  }     /* for length */

  return (outCnt);
}

int src6to5(  HANDLE_SRC hSrc6to5,
                  int16_t *input,
                  int16_t *output,
                  int     length,
                  int     stride) 
{
  int i;
  int outCnt = 0;
  /* input sample */
  int16_t inp;
  register float* states = hSrc6to5->states;
  register const float* coeff = hSrc6to5->filterCoeff;
  float gain = hSrc6to5->gain;
  int *mm = &hSrc6to5->mm;
  register int* decOut = hSrc6to5->decimationOutput;
  register float dly2;
  register float dly1;

  for (i = 0; i < length; i++) {
    /* decimation using polyphase filtering */
    inp = input[i*stride];
    switch (hSrc6to5->mm) {
    case 0:	
      (*mm)++;
      dly1 = hSrc6to5->delays[0];
      decOut[10] = fir_filter3(&states[10*N_POLY_3], &coeff[10*N_POLY_3], dly1);
      decOut[15] = fir_filter3(&states[15*N_POLY_3], &coeff[15*N_POLY_3], dly1);
      decOut[20] = fir_filter3(&states[20*N_POLY_3], &coeff[20*N_POLY_3], dly1);
      decOut[25] = fir_filter3(&states[25*N_POLY_3], &coeff[25*N_POLY_3], dly1);
      decOut[0]  = fir_filter3(&states[0]          , &coeff[0]          , inp);
      decOut[5]  = fir_filter3(&states[5*N_POLY_3],  &coeff[5*N_POLY_3],  inp);
      hSrc6to5->delays[0] = inp;
      break;
    case 4:	
      (*mm)++;
      dly2 = hSrc6to5->delays[1];
      dly1 = hSrc6to5->delays[2];
      decOut[16] = fir_filter3(&states[16*N_POLY_3], &coeff[16*N_POLY_3], dly2);
      decOut[21] = fir_filter3(&states[21*N_POLY_3], &coeff[21*N_POLY_3], dly2);
      decOut[26] = fir_filter3(&states[26*N_POLY_3], &coeff[26*N_POLY_3], dly2);
      decOut[1]  = fir_filter3(&states[1*N_POLY_3],  &coeff[1*N_POLY_3],  dly1);
      decOut[6]  = fir_filter3(&states[6*N_POLY_3],  &coeff[6*N_POLY_3],  dly1);
      decOut[11] = fir_filter3(&states[11*N_POLY_3], &coeff[11*N_POLY_3], dly1);
      hSrc6to5->delays[1] = hSrc6to5->delays[2]; 
      hSrc6to5->delays[2] = inp;
      break;
    case 3:	 
      (*mm)++;
      dly2 = hSrc6to5->delays[3];
      dly1 = hSrc6to5->delays[4];
      decOut[22] = fir_filter3(&states[22*N_POLY_3], &coeff[22*N_POLY_3], dly2);
      decOut[27] = fir_filter3(&states[27*N_POLY_3], &coeff[27*N_POLY_3], dly2);
      decOut[2]  = fir_filter3(&states[2*N_POLY_3],  &coeff[2*N_POLY_3],  dly1);
      decOut[7]  = fir_filter3(&states[7*N_POLY_3],  &coeff[7*N_POLY_3],  dly1);
      decOut[12] = fir_filter3(&states[12*N_POLY_3], &coeff[12*N_POLY_3], dly1);
      decOut[17] = fir_filter3(&states[17*N_POLY_3], &coeff[17*N_POLY_3], dly1);
      hSrc6to5->delays[3] = hSrc6to5->delays[4]; 
      hSrc6to5->delays[4] = inp;
      break;
    case 2:	
      (*mm)++;
      dly1 = hSrc6to5->delays[6];
      decOut[28] = fir_filter3(&states[28*N_POLY_3], &coeff[28*N_POLY_3], hSrc6to5->delays[5]);
      decOut[3]  = fir_filter3(&states[3*N_POLY_3],  &coeff[3*N_POLY_3],  dly1);
      decOut[8]  = fir_filter3(&states[8*N_POLY_3],  &coeff[8*N_POLY_3],  dly1);
      decOut[13] = fir_filter3(&states[13*N_POLY_3], &coeff[13*N_POLY_3], dly1);
      decOut[18] = fir_filter3(&states[18*N_POLY_3], &coeff[18*N_POLY_3], dly1);
      decOut[23] = fir_filter3(&states[23*N_POLY_3], &coeff[23*N_POLY_3], dly1);
      hSrc6to5->delays[5] = hSrc6to5->delays[6];
      hSrc6to5->delays[6] = inp;
      break;
    case 1:	
      (*mm)++;
      dly1 = hSrc6to5->delays[7];
      decOut[4]  = fir_filter3(&states[4*N_POLY_3],  &coeff[4*N_POLY_3],  dly1);
      decOut[9]  = fir_filter3(&states[9*N_POLY_3],  &coeff[9*N_POLY_3],  dly1);
      decOut[14] = fir_filter3(&states[14*N_POLY_3], &coeff[14*N_POLY_3], dly1);
      decOut[19] = fir_filter3(&states[19*N_POLY_3], &coeff[19*N_POLY_3], dly1);
      decOut[24] = fir_filter3(&states[24*N_POLY_3], &coeff[24*N_POLY_3], dly1);
      decOut[29] = fir_filter3(&states[29*N_POLY_3], &coeff[29*N_POLY_3], dly1);
      hSrc6to5->delays[7] = inp;
      break;

    default :
      return -1;
      break;
    }

    /* start upsampling by LL if decimation by MM is done */
    if (hSrc6to5->mm >= hSrc6to5->dnRatio){
      /* sum all decimated outputs and reset the switch */
      hSrc6to5->mm = 0;
#ifdef SATURATE_TD_SRC_OUTPUT
      float tmp = (float)((decOut[10] + decOut[16] + decOut[22] + decOut[28]  + decOut[4]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE( gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[15] + decOut[21] + decOut[27] + decOut[3]   + decOut[9]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[20] + decOut[26] + decOut[2]  + decOut[8]   + decOut[14]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[25] + decOut[1]  + decOut[7]  + decOut[13]  + decOut[19]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[0]  + decOut[6]  + decOut[12] + decOut[18]  + decOut[24]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
      tmp = (float)((decOut[5]  + decOut[11] + decOut[17] + decOut[23]  + decOut[29]) >> 15);
      output[outCnt++ * stride] = (float)(F_MULT_SATURATE(gain, tmp, fMult(gain, tmp)));
#else
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[10] + decOut[16] + decOut[22] + decOut[28]  + decOut[4])  >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[15] + decOut[21] + decOut[27] + decOut[3]   + decOut[9])  >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[20] + decOut[26] + decOut[2]  + decOut[8]   + decOut[14]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[25] + decOut[1]  + decOut[7]  + decOut[13]  + decOut[19]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[0]  + decOut[6]  + decOut[12] + decOut[18]  + decOut[24]) >> 15));
      output[outCnt++ * stride] = (float)fMult(gain,(float)((decOut[5]  + decOut[11] + decOut[17] + decOut[23]  + decOut[29]) >> 15));
#endif
    }   /* if dnRatio */
  }     /* for length */

  return (outCnt);
}

#endif /* USE_3_COEFFICIENTS */
#endif /* USE_2_COEFFICIENTS */
#endif /* USE_1_COEFFICIENTS */

#ifdef THIS_SRC_IS_CURRENTLY_NOT_USED
int src4to3(  HANDLE_SRC hSrc4to3,
                  int16_t *input,
                  int16_t *output,
                  int     length,
                  int     stride) 
{
  int i;

  int outCnt = 0;
  /* input sample */
  int16_t inp;
  register float* states = hSrc4to3->states;
  register const float* coeff = hSrc4to3->filterCoeff;
  register int* decOut = hSrc4to3->decimationOutput;
  register float dly1;
  for (i = 0; i < length; i++) {
    /* decimation using polyphase filtering */
    inp = input[i*stride];
    switch (hSrc4to3->mm) {
    case 0:	
      hSrc4to3->mm++;
      dly1 = hSrc4to3->delays[0];
      decOut[6] = fir_filter7(&states[6*7], &coeff[6*7], N_POLY_7, dly1);
      decOut[9] = fir_filter7(&states[9*7], &coeff[9*7], N_POLY_7, dly1);
      decOut[0] = fir_filter7(&states[0]  , &coeff[0]  , N_POLY_7, inp);
      decOut[3] = fir_filter7(&states[3*7], &coeff[3*7], N_POLY_7, inp);
      hSrc4to3->delays[0] = inp;
      break;
    case 2:	
      hSrc4to3->mm++;
      dly1 = hSrc4to3->delays[1];
      decOut[10] = fir_filter7(&states[10*7], &coeff[10*7],N_POLY_7, hSrc4to3->delays[2]);
      decOut[1]  = fir_filter7(&states[1*7],  &coeff[1*7], N_POLY_7, dly1);
      decOut[4]  = fir_filter7(&states[4*7],  &coeff[4*7], N_POLY_7, dly1);
      decOut[7]  = fir_filter7(&states[7*7],  &coeff[7*7], N_POLY_7, dly1);
      hSrc4to3->delays[2] = hSrc4to3->delays[1];
      hSrc4to3->delays[1] = inp;
      break;
    case 1:	
      hSrc4to3->mm++;
      dly1 = hSrc4to3->delays[3];
      decOut[2]  = fir_filter7(&states[2*7],  &coeff[2*7], N_POLY_7, dly1);
      decOut[5]  = fir_filter7(&states[5*7],  &coeff[5*7], N_POLY_7, dly1);
      decOut[8]  = fir_filter7(&states[8*7],  &coeff[8*7], N_POLY_7, dly1);
      decOut[11] = fir_filter7(&states[11*7], &coeff[11*7],N_POLY_7, dly1);
      hSrc4to3->delays[3] = inp;
      break;

    default :
      return -1;
      break;
    }

    /* start upsampling by LL if decimation by MM is done */
    if (hSrc4to3->mm >= hSrc4to3->dnRatio){
      /* sum all decimated outputs and reset the switch */
      hSrc4to3->mm = 0;
      output[outCnt++ * stride] = (float)((decOut[6] + decOut[10] + decOut[2])  >> 15);
      output[outCnt++ * stride] = (float)((decOut[9] + decOut[1]  + decOut[5])  >> 15);
      output[outCnt++ * stride] = (float)((decOut[0] + decOut[4]  + decOut[8])  >> 15);
      output[outCnt++ * stride] = (float)((decOut[3] + decOut[7]  + decOut[11]) >> 15);
    }   /* if dnRatio */
  }     /* for length */

  return (outCnt);
}
#endif

void srcClose (HANDLE_SRC hSrc)
{
    if(hSrc->decimationOutput != NULL){
      free(hSrc->decimationOutput);
      hSrc->decimationOutput = NULL;
    }
    if(hSrc->delays != NULL){
      free(hSrc->delays);
      hSrc->delays = NULL;
    }
    if(hSrc->states != NULL){
      free(hSrc->states);
      hSrc->states = NULL;
    }
}
